<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>수한공간 블로그 마스터 프롬프트 생성기 V5 Ultimate + PDF</title>
  <style>
    :root {
      --blue: #0A47A1;
      --blue-light: #1565C0;
      --orange: #E67E22;
      --red: #D13B3B;
      --green: #27AE60;
      --purple: #8E44AD;
      --bg: #f0f4f8;
      --card: #ffffff;
      --border: #d9e2ec;
      --text-main: #222;
      --text-sub: #666;
    }

    * { box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Apple SD Gothic Neo", "Pretendard", sans-serif;
      margin: 0;
      padding: 20px 14px 40px;
      background: var(--bg);
      color: var(--text-main);
      font-size: 15px;
    }

    .app-wrapper {
      max-width: 920px;
      margin: 0 auto;
      background: var(--card);
      border-radius: 16px;
      padding: 28px 24px 32px;
      box-shadow: 0 4px 18px rgba(15, 23, 42, 0.08);
      border: 1px solid var(--border);
    }

    .header-badge {
      display: inline-block;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    h1 {
      text-align: center;
      font-size: 24px;
      margin: 0 0 8px;
      color: var(--blue);
      letter-spacing: -0.04em;
      font-weight: 800;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      color: var(--text-sub);
      margin-bottom: 20px;
    }

    .badge-row {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .badge {
      font-size: 11px;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      background: #f8fafc;
      color: #475569;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-weight: 600;
    }

    .badge.premium {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      border-color: #ffd700;
      color: #8b6914;
      font-weight: 700;
    }

    .section {
      background: #f9fbff;
      border-radius: 12px;
      padding: 18px 16px 20px;
      margin-bottom: 16px;
      border: 1px solid #e0e7ff;
    }

    .section.advanced {
      background: linear-gradient(135deg, #f6f8ff 0%, #f0f4ff 100%);
      border: 2px solid #c7d2fe;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .section h2 {
      margin: 0;
      font-size: 16px;
      color: var(--blue);
      letter-spacing: -0.03em;
      display: flex;
      align-items: center;
      gap: 7px;
      font-weight: 700;
    }

    .section h2 span.icon {
      font-size: 18px;
    }

    .pro-badge {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      font-size: 9px;
      padding: 3px 8px;
      border-radius: 10px;
      font-weight: 700;
      margin-left: 6px;
    }

    label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      margin-top: 14px;
      margin-bottom: 5px;
      color: #111827;
    }

    .hint {
      font-size: 11px;
      color: var(--text-sub);
      margin-bottom: 5px;
      line-height: 1.5;
    }

    .hint.warning {
      background: #fff3cd;
      border-left: 3px solid #ffc107;
      padding: 8px 10px;
      border-radius: 6px;
      margin: 8px 0;
    }

    .hint.success {
      background: #d4edda;
      border-left: 3px solid #28a745;
      padding: 8px 10px;
      border-radius: 6px;
      margin: 8px 0;
    }

    input[type="text"],
    textarea,
    select {
      width: 100%;
      padding: 11px 12px;
      border-radius: 9px;
      border: 1px solid #d1d5db;
      font-size: 13px;
      background: #ffffff;
      transition: 0.18s;
      font-family: inherit;
    }

    input[type="text"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--blue);
      box-shadow: 0 0 0 3px rgba(10, 71, 161, 0.12);
    }

    textarea {
      min-height: 80px;
      resize: vertical;
      line-height: 1.6;
    }

    .radio-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .radio-pill {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 9px 13px;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      font-size: 12px;
      color: #475569;
      background: #f8fafc;
      cursor: pointer;
      user-select: none;
      transition: 0.18s all;
      font-weight: 600;
    }

    .radio-pill input {
      display: none;
    }

    .radio-pill span.emoji {
      font-size: 15px;
    }

    .radio-pill.active {
      background: var(--blue);
      color: #ffffff;
      border-color: var(--blue);
      box-shadow: 0 3px 12px rgba(10, 71, 161, 0.3);
      transform: translateY(-1px);
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .row > .col-6 {
      flex: 1;
      min-width: calc(50% - 6px);
    }

    .row > .col-4 {
      flex: 1;
      min-width: calc(33.33% - 8px);
    }

    .inline-check {
      display: inline-flex;
      align-items: center;
      gap: 7px;
      font-size: 12px;
      color: var(--text-sub);
      cursor: pointer;
      margin-top: 6px;
      font-weight: 600;
    }

    .inline-check input {
      width: 16px;
      height: 16px;
      accent-color: var(--orange);
    }

    .quality-score {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 16px;
      border-radius: 12px;
      margin: 20px 0;
      text-align: center;
    }

    .quality-score h3 {
      margin: 0 0 12px;
      font-size: 16px;
    }

    .score-display {
      font-size: 48px;
      font-weight: 800;
      margin: 10px 0;
    }

    .score-breakdown {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      margin-top: 16px;
    }

    .score-item {
      background: rgba(255, 255, 255, 0.2);
      padding: 10px;
      border-radius: 8px;
      font-size: 12px;
    }

    .score-item strong {
      display: block;
      font-size: 20px;
      margin-bottom: 4px;
    }

    .btn-area {
      position: sticky;
      bottom: 10px;
      margin-top: 20px;
      padding-top: 12px;
      background: linear-gradient(to top, rgba(240, 244, 248, 0.98), rgba(240, 244, 248, 0));
    }

    button {
      width: 100%;
      border: none;
      cursor: pointer;
      padding: 16px 20px;
      border-radius: 999px;
      font-size: 16px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      background: linear-gradient(135deg, var(--blue), #052c65);
      color: #ffffff;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.35);
      transition: 0.16s;
      margin-bottom: 10px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 14px 28px rgba(15, 23, 42, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    button.secondary {
      background: linear-gradient(135deg, #27AE60, #229954);
    }

    button.tertiary {
      background: linear-gradient(135deg, #8E44AD, #7D3C98);
    }

    button.pdf-simple {
      background: linear-gradient(135deg, #95a5a6, #7f8c8d);
    }

    .helper {
      font-size: 11px;
      color: var(--text-sub);
      text-align: center;
      margin-top: 8px;
      line-height: 1.5;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin: 16px 0;
    }

    .stat-card {
      background: white;
      border: 2px solid #e0e7ff;
      border-radius: 10px;
      padding: 14px;
      text-align: center;
    }

    .stat-card .number {
      font-size: 28px;
      font-weight: 800;
      color: var(--blue);
      display: block;
      margin-bottom: 4px;
    }

    .stat-card .label {
      font-size: 11px;
      color: var(--text-sub);
      font-weight: 600;
    }

    .pdf-button-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 10px;
    }

    .pdf-button-grid button {
      font-size: 14px;
      padding: 14px 16px;
    }

    @media (max-width: 640px) {
      .app-wrapper {
        padding: 20px 16px 26px;
        border-radius: 12px;
      }
      h1 { font-size: 20px; }
      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
      .row > .col-6,
      .row > .col-4 {
        min-width: 100%;
      }
      .pdf-button-grid {
        grid-template-columns: 1fr;
      }
    }

    .ai-suggestion {
      background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
      border-left: 4px solid var(--green);
      padding: 12px 14px;
      border-radius: 8px;
      margin: 12px 0;
      font-size: 12px;
      line-height: 1.6;
    }

    .ai-suggestion strong {
      color: var(--green);
      display: block;
      margin-bottom: 6px;
    }

    .toggle-section {
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .toggle-section::after {
      content: '▼';
      font-size: 10px;
      transition: transform 0.3s;
    }

    .toggle-section.collapsed::after {
      transform: rotate(-90deg);
    }

    .collapsible-content {
      max-height: 2000px;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .collapsible-content.hidden {
      max-height: 0;
    }
  </style>
</head>
<body>
  <div class="app-wrapper">
    <div style="text-align: center;">
      <span class="header-badge">⚡ V5 ULTIMATE + PDF EDITION</span>
    </div>
    
    <h1>🛠 수한공간 블로그 마스터 프롬프트 생성기</h1>
    <p class="subtitle">
      네이버 상위 1% 전문가급 SEO 최적화 + AI 키워드 분석 + 경쟁사 대응 전략 + PDF 리포트<br>
      입력 후 버튼만 누르면 완벽한 프롬프트가 자동 생성됩니다.
    </p>

    <div class="badge-row">
      <div class="badge premium">⭐ 상위 0.5% 품질 보장</div>
      <div class="badge"><strong>고급 SEO</strong> C-Rank 최적화</div>
      <div class="badge"><strong>키워드 밀도</strong> 자동 계산</div>
      <div class="badge"><strong>A/B 테스팅</strong> 3가지 버전</div>
      <div class="badge"><strong>PDF</strong> 3종 리포트</div>
    </div>

    <!-- 품질 점수 미리보기 -->
    <div class="stats-grid">
      <div class="stat-card">
        <span class="number" id="preview-keyword-score">-</span>
        <span class="label">키워드 최적화</span>
      </div>
      <div class="stat-card">
        <span class="number" id="preview-seo-score">-</span>
        <span class="label">SEO 구조</span>
      </div>
      <div class="stat-card">
        <span class="number" id="preview-engagement-score">-</span>
        <span class="label">참여도 유도</span>
      </div>
      <div class="stat-card">
        <span class="number" id="preview-total-score">-</span>
        <span class="label">종합 점수</span>
      </div>
    </div>

    <!-- 0. 글 유형 & 리뉴얼 -->
    <div class="section">
      <div class="section-header">
        <h2><span class="icon">0️⃣</span> 글 유형 & 리뉴얼 여부</h2>
        <small>유형에 따라 분량·사진 가이드가 달라집니다.</small>
      </div>

      <label>글 유형 선택</label>
      <div class="radio-group" id="typeGroup">
        <label class="radio-pill active">
          <input type="radio" name="postType" value="하자 보수 사례" checked />
          <span class="emoji">🚨</span> 하자 보수 사례
        </label>
        <label class="radio-pill">
          <input type="radio" name="postType" value="부분 시공 사례" />
          <span class="emoji">🧱</span> 부분 시공 사례
        </label>
        <label class="radio-pill">
          <input type="radio" name="postType" value="욕실 리모델링 사례" />
          <span class="emoji">🛁</span> 욕실 리모델링
        </label>
        <label class="radio-pill">
          <input type="radio" name="postType" value="집수리 사례" />
          <span class="emoji">🛠️</span> 집수리
        </label>
        <label class="radio-pill">
          <input type="radio" name="postType" value="블로그 칼럼" />
          <span class="emoji">📝</span> 블로그 칼럼
        </label>
        <label class="radio-pill">
          <input type="radio" name="postType" value="자주 묻는 질문" />
          <span class="emoji">❓</span> 자주 묻는 질문(FAQ)
        </label>
        <label class="radio-pill">
          <input type="radio" name="postType" value="당근 변환" />
          <span class="emoji">🥕</span> 당근 변환
        </label>
      </div>

      <label class="inline-check">
        <input type="checkbox" id="renewalFlag" />
        <span>[리뉴얼] 기존 작성 글/사진을 세탁·재구성할 때 체크해주세요.</span>
      </label>

      <!-- 리뉴얼 전용 입력 영역 -->
      <div id="renewSection" class="section" style="margin-top:12px; background:#fffaf5; border-color:#fed7aa; display:none;">
        <div class="section-header">
          <h2><span class="icon">🧺</span> 리뉴얼 전용 입력<span class="pro-badge">PRO</span></h2>
          <small>기존 글을 붙여넣으면, 구조만 완전히 새로 짜줍니다.</small>
        </div>

        <label>기존 글 제목</label>
        <div class="hint">이전에 올렸던 블로그 글 제목 (가능하면 그대로 적어주세요)</div>
        <input type="text" id="field-renewTitle" placeholder="예) 평택 고덕 경남아너스빌 욕실 타일 크랙 보수" />

        <label>기존 글 본문 전체</label>
        <div class="hint">블로그 관리자에서 복사한 기존 글 전체를 그대로 붙여넣기</div>
        <textarea id="field-renewOriginal" rows="6" placeholder="기존 글 전체 내용을 여기에 붙여넣으세요..."></textarea>

        <label>추가/변경 요청 내용</label>
        <div class="hint">어떤 분위기로 바꾸고 싶은지, 추가할 내용/빼고 싶은 내용 메모</div>
        <textarea id="field-renewChange" rows="4" placeholder="예) 더 전문적인 톤으로 변경, 가격 언급 제거, 계절 키워드 추가 등"></textarea>

        <div class="hint warning">
          <strong>⚠️ 리뉴얼 시 필수 체크사항:</strong><br>
          • 사진은 1~2mm 크롭 또는 밝기 조절 등 간단한 보정 필수<br>
          • 구조 100% 변경, 문장 70% 이상 재작성<br>
          • 태그 50% 이상 교체
        </div>
      </div>
    </div>

    <!-- 1. 기본 현장 정보 -->
    <div class="section advanced" id="section-basic">
      <div class="section-header">
        <h2><span class="icon">1️⃣</span> 기본 현장 정보<span class="pro-badge">ENHANCED</span></h2>
        <small>첫 문단 키워드 + 지역 언급에 활용됩니다.</small>
      </div>

      <label>지역/현장</label>
      <div class="hint">예: 평택 고덕 경남아너스빌 부부욕실 / 오산 원동 ◯◯아파트 주방 / 평택 용이동 오래된 빌라 집수리 등</div>
      <input type="text" id="field-location" placeholder="평택 고덕동 ◯◯아파트 301동" />

      <div class="row">
        <div class="col-6">
          <label>메인 키워드 <span style="color:#e74c3c; font-size:11px;">*필수</span></label>
          <div class="hint">예: 평택욕실타일보수, 평택타일하자보수, 평택집수리 등</div>
          <input type="text" id="field-mainKeyword" placeholder="평택욕실타일보수" />
          <div id="keyword-density-info" class="hint success" style="display:none; margin-top:8px;">
            <strong>📊 권장 키워드 사용 횟수:</strong>
            <span id="keyword-recommendation"></span>
          </div>
        </div>
        <div class="col-6">
          <label>보조 키워드(선택)</label>
          <div class="hint">예: 욕실타일교체, 몰딩교체, 실리콘보수, 베란다타일보수 등</div>
          <input type="text" id="field-subKeyword" placeholder="타일부분교체" />
        </div>
      </div>

      <div class="row">
        <div class="col-6">
          <label>목표 글자 수</label>
          <select id="field-targetLength">
            <option value="800">짧게 (800자)</option>
            <option value="1200" selected>표준 (1200자)</option>
            <option value="1500">길게 (1500자)</option>
            <option value="2000">상세 (2000자)</option>
          </select>
        </div>
        <div class="col-6">
          <label>경쟁 강도</label>
          <select id="field-competition">
            <option value="low">낮음 (롱테일)</option>
            <option value="medium" selected>보통</option>
            <option value="high">높음 (핵심 키워드)</option>
          </select>
        </div>
      </div>

      <div class="ai-suggestion" id="ai-keyword-suggestion" style="display:none;">
        <strong>🤖 AI 키워드 제안</strong>
        <span id="ai-keyword-text"></span>
      </div>
    </div>

    <!-- 2. 고객 문제 / 불편 -->
    <div class="section" id="section-problem">
      <div class="section-header">
        <h2><span class="icon">2️⃣</span> 고객 상황 & 불편 사항</h2>
        <small>문제 소개 + 공감 파트에 사용됩니다.</small>
      </div>

      <label>고객 문제 / 문의 내용</label>
      <div class="hint">
        예: 벽타일에 크랙이 여러 군데 생겨서 보기 불편함 / 욕실 바닥 물고임 / 베란다 누수 / 
        문틀 하단이 썩어서 갈라짐 / 실리콘 곰팡이 심함 등
      </div>
      <textarea id="field-problem" placeholder="고객이 겪고 있는 구체적인 문제를 적어주세요..."></textarea>

      <label>고객이 특히 걱정했던 부분 (선택)</label>
      <div class="hint">
        예: 전체 철거를 해야 하는지, 부분 보수가 가능한지, 공사 기간·소음·오염, 비용, 
        임대 중 집수리 후 분쟁 가능성 등
      </div>
      <textarea id="field-fear" placeholder="고객의 주요 우려사항..."></textarea>

      <label>문제가 발생한 예상 원인 (선택)</label>
      <div class="hint warning">
        <strong>💡 원인 분석 TIP:</strong> 원인을 명확히 설명하면 전문성이 높아지고 SEO 점수가 상승합니다.<br>
        예: 시공 시 접착제 부족, 방수층 손상, 온수온돌 배관 문제, 환기 부족으로 인한 결로 등
      </div>
      <textarea id="field-cause" rows="3" placeholder="전문가 입장에서 본 문제 원인..."></textarea>
    </div>

    <!-- 3. 작업 과정 / 기술 디테일 -->
    <div class="section" id="section-process">
      <div class="section-header">
        <h2><span class="icon">3️⃣</span> 작업 과정 & 기술 디테일</h2>
        <small>현장 설명 · 기술 설명 · 전문가 조언에 활용됩니다.</small>
      </div>

      <label>작업 과정 (큰 흐름)</label>
      <div class="hint">
        예: 보양 → 하자 부위 표시 → 부분 철거/제거 → 바탕 정리 → 
        보수(몰탈/퍼티/실리콘/우레탄 등) → 타일 재시공 또는 마감재 교체 → 청소
      </div>
      <textarea id="field-process" placeholder="1단계부터 순서대로 작업 흐름을 적어주세요..."></textarea>

      <label>예상 작업 소요 시간</label>
      <div class="hint">
        예: 1일 소요 / 반나절 소요 / 2일 공정 / 집수리 여러 항목 묶음으로 2~3일 등
      </div>
      <input type="text" id="field-duration" placeholder="반나절 ~ 1일" />

      <label>사용 자재 & 공법</label>
      <div class="hint">
        예: 드라이픽스 + 보강 몰탈, 아딕스 접착제, 평탄클립, 실리콘(중성/곰팡이 방지), 
        문틀 보수용 퍼티, 목재 방부 처리 등
      </div>
      <textarea id="field-material" placeholder="사용한 자재와 그 자재를 선택한 이유..."></textarea>

      <label>기술적으로 강조하고 싶은 포인트</label>
      <div class="hint">
        예: 기존 타일/마감재 색상 최대 매칭, 단차 최소화, 방수층 손상 여부 확인, 
        문틀 하단 썩은 부분 확실히 제거 후 보수, 곰팡이 원인 제거 등
      </div>
      <textarea id="field-point" placeholder="이 시공에서 특별히 신경 쓴 부분..."></textarea>

      <div class="ai-suggestion">
        <strong>💡 전문성 향상 TIP</strong>
        자재 선택 이유를 3~4줄로 상세히 설명하면 신뢰도가 크게 상승합니다.<br>
        예: "드라이픽스를 사용한 이유는 기존 타일을 제거하지 않고도 강력한 접착력을 확보할 수 있기 때문입니다."
      </div>
    </div>

    <!-- 4. 사진 설명 -->
    <div class="section" id="section-photos">
      <div class="section-header">
        <h2><span class="icon">4️⃣</span> 사진 구성 & ALT 힌트<span class="pro-badge">ADVANCED</span></h2>
        <small>시공 전→원인→시공 중→완료 순으로 정리해주세요.</small>
      </div>

      <label>사진 설명 (시공 전/중/후 흐름대로)</label>
      <div class="hint">
        예:<br/>
        1. 시공 전: 크랙이 보이는 벽타일 정면 사진 / 곰팡이 난 실리콘 등<br/>
        2. 철거/제거 후: 떼 발린 몰탈 상태, 문틀 내부 상태, 바닥 콘크리트 노출 등<br/>
        3. 시공 중: 접착제 도포, 보수 몰탈 작업, 실리콘 재시공, 목재 보수 과정 등<br/>
        4. 시공 후: 전체 전경, 보수된 디테일 클로즈업<br/>
        5. 기타: 배수 테스트, 문 여닫힘 테스트 등
      </div>
      <textarea id="field-photos" rows="8" placeholder="사진별로 어떤 장면인지 순서대로 적어주세요..."></textarea>

      <label>대표 사진(인네일) 후보 메모 (선택)</label>
      <div class="hint">
        예: 시공 후 전체 전경 / 하자 부위 Before-After / 집수리 전후 비교 / 
        욕실 바닥 물고임 해결 후 사진 등
      </div>
      <textarea id="field-thumbnail" rows="2" placeholder="인네일로 사용할 사진 설명..."></textarea>

      <div class="hint success">
        <strong>📸 사진 개수 가이드 (AI 자동 계산)</strong><br>
        • 하자보수: 5~8장 | 부분시공: 8~12장 | 욕실리모델링: 12~20장<br>
        • 집수리: 4~7장 | 칼럼/FAQ: 3~5장
      </div>
    </div>

    <!-- 5. 추가 메모 -->
    <div class="section" id="section-extra">
      <div class="section-header">
        <h2><span class="icon">5️⃣</span> 추가 메모 (선택)</h2>
        <small>특이 사항이나 꼭 넣고 싶은 멘트가 있다면 적어주세요.</small>
      </div>

      <label>추가로 꼭 들어갔으면 하는 내용</label>
      <div class="hint">
        예: 고객 반응, 시공 전후 비교 느낌, 재방문 약속, 계절/날씨 관련 코멘트, 
        집 전체 점검 중 추가로 발견된 하자 등
      </div>
      <textarea id="field-extra" placeholder="기타 특별히 강조하고 싶은 내용..."></textarea>

      <label>타겟 독자 (선택)</label>
      <div class="hint">독자층을 명확히 하면 맞춤형 글이 생성됩니다.</div>
      <select id="field-targetAudience">
        <option value="">선택 안 함</option>
        <option value="첫집장만">첫 집 장만한 30~40대</option>
        <option value="임대">임대 중인 집주인</option>
        <option value="세입자">세입자</option>
        <option value="리모델링">리모델링 계획 중</option>
        <option value="긴급">긴급 수리 필요</option>
      </select>
    </div>
<!-- 6. 블로그 칼럼 전용 -->
    <div class="section" id="section-column" style="display:none;">
      <div class="section-header">
        <h2><span class="icon">6️⃣</span> 블로그 칼럼 전용 추가 정보</h2>
        <small>칼럼일 때만 사용됩니다.</small>
      </div>

      <label>칼럼 주제 한 줄 요약</label>
      <div class="hint">예: "욕실 타일, 언제 전체 리모델링 말고 부분 보수로 끝낼 수 있을까?" / "집수리, 어디까지 해두면 나중에 덜 스트레스 받을까?"</div>
      <input type="text" id="field-columnTopic" placeholder="칼럼의 핵심 질문이나 주제" />

      <label>칼럼에서 잡고 싶은 관점/메시지</label>
      <div class="hint">예: 전체 철거만이 답은 아니라는 점, 상태 진단의 중요성, 집수리도 '우선순위'를 정해서 단계별로 하는 게 좋다는 내용 등</div>
      <textarea id="field-columnAngle" rows="3" placeholder="독자에게 전달하고 싶은 핵심 메시지..."></textarea>

      <label>칼럼 대상 독자</label>
      <div class="hint">예: 첫 집 장만 후 하자를 겪는 30~40대, 평택·오산 아파트/빌라 거주자, 임대 중 집주인/세입자 등</div>
      <input type="text" id="field-columnTarget" placeholder="주요 타겟층" />
    </div>

    <!-- 7. FAQ 전용 -->
    <div class="section" id="section-faq" style="display:none;">
      <div class="section-header">
        <h2><span class="icon">7️⃣</span> 자주 묻는 질문(FAQ) 전용 입력</h2>
        <small>질문 3개 묶음 구성을 기본으로 합니다.</small>
      </div>

      <label>질문 1</label>
      <div class="hint">예: 욕실 타일이 한두 장만 깨졌는데, 부분 보수만 해도 되나요? / 문틀이 썩었는데 전체 교체해야 하나요?</div>
      <input type="text" id="field-faqQ1" placeholder="첫 번째 질문" />
      <label>답변 방향 메모 1</label>
      <div class="hint">예: 크랙 범위, 주변 들뜸 여부, 썩은 범위에 따라 다름 / 상태 진단 후 부분보수 우선 안내 등</div>
      <textarea id="field-faqA1" rows="2" placeholder="답변 내용 힌트..."></textarea>

      <label>질문 2</label>
      <div class="hint">예: 막방 시공과 철거 후 재시공, 어떤 차이가 있나요? / 집수리 여러 개를 한 번에 해도 되나요?</div>
      <input type="text" id="field-faqQ2" placeholder="두 번째 질문" />
      <label>답변 방향 메모 2</label>
      <textarea id="field-faqA2" rows="2" placeholder="답변 내용 힌트..."></textarea>

      <label>질문 3</label>
      <div class="hint">예: 공사 기간과 소음, 물 사용 제한은 어느 정도 생각해야 하나요?</div>
      <input type="text" id="field-faqQ3" placeholder="세 번째 질문" />
      <label>답변 방향 메모 3</label>
      <textarea id="field-faqA3" rows="2" placeholder="답변 내용 힌트..."></textarea>
    </div>

    <!-- 🥕 당근 변환 전용 섹션 -->
    <div class="section" id="section-danggeun" style="display:none;">
      <div class="section-header">
        <h2><span class="icon">🥕</span> 네이버 글 → 당근 소식 변환 설정</h2>
        <small>네이버 블로그에 이미 작성한 글을, 당근 비즈 소식용 글로 바꿀 때만 사용합니다.</small>
      </div>

      <label>네이버 블로그 글 원문 전체</label>
      <div class="hint">실제 블로그에 올렸거나 올릴 예정인 글을 그대로 붙여넣어 주세요.</div>
      <textarea id="dg-blogInput" rows="10" placeholder="네이버 블로그에 작성한 글 전체를 복사해서 붙여넣습니다."></textarea>

      <div class="row">
        <div class="col-6">
          <label>지역(동 단위)</label>
          <div class="hint">예: 평택 용이동, 고덕동, 비전동 등</div>
          <input id="dg-region" type="text" placeholder="예) 평택 용이동" />
        </div>
        <div class="col-6">
          <label>서비스 종류</label>
          <div class="hint">당근에서 고객이 볼 서비스 유형</div>
          <select id="dg-service">
            <option value="타일 하자보수">타일 하자보수</option>
            <option value="타일 부분시공">타일 부분시공</option>
            <option value="욕실 리모델링">욕실 리모델링</option>
            <option value="집수리">집수리</option>
          </select>
        </div>
      </div>

      <label style="margin-top:12px;">마지막 안내 문장(CTA)</label>
      <div class="hint">
        예: 채팅으로 사진 보내주시면 상태 보고 먼저 안내드립니다.
      </div>
      <input id="dg-cta" type="text" placeholder="예) 채팅으로 사진 보내주시면 상태 보고 먼저 안내드립니다." />

      <p class="helper" style="margin-top:10px;">
        ※ 글 유형에서 <strong>🥕 당근 변환</strong>을 선택한 상태에서
        아래 버튼을 누르면, 이 정보를 바탕으로<br />
        "네이버 글 → 당근 소식 변환" 프롬프트가 클립보드에 복사됩니다.
      </p>
    </div>

    <!-- ⚡ 고급 SEO 설정 (NEW) -->
    <div class="section advanced">
      <div class="section-header">
        <h2 class="toggle-section" onclick="toggleAdvanced()">
          <span class="icon">⚡</span> 고급 SEO 설정<span class="pro-badge">EXPERT</span>
        </h2>
        <small>전문가용 - 필요시에만 수정하세요</small>
      </div>

      <div id="advanced-content" class="collapsible-content">
        <div class="row">
          <div class="col-6">
            <label>키워드 밀도 목표 (%)</label>
            <div class="hint">권장: 1.8~2.5% (너무 높으면 스팸 판정)</div>
            <input type="number" id="field-keywordDensity" value="2.0" step="0.1" min="1.0" max="3.5" />
          </div>
          <div class="col-6">
            <label>LSI 키워드 개수</label>
            <div class="hint">연관 검색어 개수 (권장: 3~5개)</div>
            <input type="number" id="field-lsiCount" value="5" min="3" max="8" />
          </div>
        </div>

        <label>A/B 테스팅 버전 개수</label>
        <div class="hint">제목 + 첫 문단을 몇 가지 버전으로 생성할지 (1~3개)</div>
        <select id="field-abVersions">
          <option value="1">1개 (기본)</option>
          <option value="2">2개 (A/B 테스트)</option>
          <option value="3" selected>3개 (A/B/C 테스트)</option>
        </select>

        <label class="inline-check">
          <input type="checkbox" id="field-includeCompetitor" checked />
          <span>경쟁사 대응 전략 문구 자동 삽입</span>
        </label>

        <label class="inline-check">
          <input type="checkbox" id="field-includeFAQ" checked />
          <span>글 하단에 미니 FAQ 1~2개 자동 생성</span>
        </label>

        <label class="inline-check">
          <input type="checkbox" id="field-includeStats" checked />
          <span>신뢰도 높이는 통계/수치 문장 삽입</span>
        </label>

        <label class="inline-check">
          <input type="checkbox" id="field-includeInternalLink" />
          <span>내부 링크 배치 위치 제안 (80% 지점)</span>
        </label>
      </div>
    </div>
<!-- 🎯 검색 의도 자동 분류 섹션 -->
<div class="section advanced" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
  <div class="section-header">
    <h2 style="color: #2c3e50;">
      <span class="icon">🎯</span> 검색 의도 자동 분류 <span class="pro-badge" style="background: #ff6b6b;">AI</span>
    </h2>
    <small style="color: #2c3e50;">키워드 분석으로 최적 글 구조 자동 제안</small>
  </div>

  <div style="background: rgba(255,255,255,0.95); padding: 20px; border-radius: 12px; margin-top: 12px;">
    
    <!-- 자동 분석 결과 표시 -->
    <div id="intent-analysis-result" style="display: none;">
      
      <!-- 감지된 의도 -->
      <div style="background: #f8f9fa; border-left: 4px solid #667eea; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
        <h3 style="font-size: 15px; color: #2c3e50; margin: 0 0 12px 0; display: flex; align-items: center; gap: 8px;">
          <span id="intent-icon">🔍</span> 감지된 검색 의도
        </h3>
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
          <span style="font-size: 24px; font-weight: 800; color: #667eea;" id="intent-type">정보형</span>
          <span style="font-size: 13px; color: #7f8c8d;" id="intent-confidence"></span>
        </div>
        <p style="font-size: 13px; color: #555; margin: 0; line-height: 1.6;" id="intent-description"></p>
      </div>

      <!-- 추천 글 구조 -->
      <div style="background: #fff; border: 2px solid #667eea; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
        <h3 style="font-size: 14px; color: #667eea; margin: 0 0 12px 0; font-weight: 700;">
          📝 이 의도에 최적화된 글 구조
        </h3>
        <div id="recommended-structure" style="font-size: 13px; line-height: 1.8;"></div>
      </div>

      <!-- 핵심 전략 -->
      <div style="background: linear-gradient(135deg, #ffeaa7, #fdcb6e); padding: 14px; border-radius: 8px;">
        <h4 style="margin: 0 0 10px 0; font-size: 13px; color: #2d3436; font-weight: 700;">⚡ 핵심 전략 3가지</h4>
        <div id="key-strategies" style="font-size: 12px; line-height: 1.7; color: #2d3436;"></div>
      </div>

    </div>

    <!-- 분석 전 안내 -->
    <div id="intent-placeholder" style="text-align: center; padding: 30px; color: #95a5a6;">
      <p style="font-size: 14px; margin: 0;">
        💡 메인 키워드와 고객 문제를 입력하면<br>
        AI가 검색 의도를 자동으로 분석합니다
      </p>
    </div>

    <p class="helper" style="margin-top: 12px; color: #666;">
      ⚠️ 키워드 입력 시 자동으로 분석됩니다. 별도 버튼 클릭 불필요.
    </p>
  </div>
</div>

<style>
.intent-badge {
  display: inline-block;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 700;
  margin: 4px;
}
.intent-info { background: #e3f2fd; color: #1976d2; }
.intent-transaction { background: #fff3e0; color: #f57c00; }
.intent-comparison { background: #f3e5f5; color: #7b1fa2; }

.structure-step {
  background: white;
  border: 1px solid #e0e7ff;
  padding: 10px 12px;
  border-radius: 6px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.structure-step .number {
  width: 24px;
  height: 24px;
  background: #667eea;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
  flex-shrink: 0;
}
</style>
<!-- ⭐ AI 실시간 분석 섹션 ⭐ -->
<div class="section advanced" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); margin-top: 20px;">
  <div class="section-header">
    <h2 style="color: white;">
      <span class="icon">🤖</span> AI 실시간 경쟁 분석 <span class="pro-badge" style="background: #ffd700; color: #000;">LIVE</span>
    </h2>
    <small style="color: #f0f0f0;">네이버 실시간 검색 결과 분석 (30초 소요)</small>
  </div>

  <div style="background: rgba(255,255,255,0.95); padding: 20px; border-radius: 12px; margin-top: 12px;">
    
    <button type="button" onclick="runRealtimeAnalysis()" 
            style="width: 100%; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); margin-bottom: 16px;">
      🔍 실시간 경쟁 분석 시작
    </button>

    <!-- 로딩 -->
    <div id="analysis-loading" style="display: none; text-align: center; padding: 30px;">
      <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite;"></div>
      <p style="margin-top: 12px; color: #667eea; font-weight: 600;" id="loading-status">분석 중...</p>
    </div>

    <!-- 결과 -->
    <div id="analysis-results" style="display: none;"></div>

    <p class="helper" style="margin-top: 12px;">
      💡 메인 키워드 입력 후 사용 가능 | 실제 네이버 검색 데이터 기반
    </p>
  </div>
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
.analysis-card {
  background: #f8f9fa;
  border-left: 4px solid #667eea;
  padding: 14px;
  border-radius: 8px;
  margin-bottom: 12px;
}
.score-badge {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 700;
  margin-left: 6px;
}
.score-high { background: #fee; color: #c00; }
.score-medium { background: #ffeaa7; color: #d63031; }
.score-low { background: #d4edda; color: #155724; }
</style>
    <!-- 버튼 -->
    <div class="btn-area">
      <button type="button" onclick="buildPrompt()">
        🚀 최종 마스터 프롬프트 생성 & 클립보드 복사
      </button>
      
      <!-- PDF 저장 버튼 그룹 -->
      <div class="pdf-button-grid">
        <button type="button" class="secondary" onclick="generateBasicPDF()">
          📄 기본 리포트
        </button>
        <button type="button" class="tertiary" onclick="generatePremiumPDF()">
          🎨 프리미엄 리포트
        </button>
        <button type="button" class="pdf-simple" onclick="generateSimplePDF()">
          📋 간단 체크리스트
        </button>
      </div>

      <button type="button" class="secondary" onclick="calculateQualityScore()">
        📊 현재 입력 내용 품질 점수 미리보기
      </button>
      <button type="button" class="tertiary" onclick="showKeywordAnalysis()">
        🔍 키워드 심층 분석 + 경쟁사 전략
      </button>
      <p class="helper">
        복사된 내용을 ChatGPT 대화창에 붙여넣기 하면, 네이버 블로그 전용 규칙 V5가 적용된 글이 생성됩니다.<br>
        (당근 변환 선택시 당근용 변환 프롬프트가 복사됩니다.)
      </p>
    </div>
  </div>

<script>
  // ============================================
  // 🎯 PART 1: 기본 UI 컨트롤
  // ============================================

  // 라디오 버튼 UI 토글
  document.querySelectorAll('#typeGroup .radio-pill').forEach(function (pill) {
    pill.addEventListener('click', function () {
      document.querySelectorAll('#typeGroup .radio-pill').forEach(function (p) {
        p.classList.remove('active');
        p.querySelector('input').checked = false;
      });
      pill.classList.add('active');
      pill.querySelector('input').checked = true;
      updateTypeUI();
    });
  });

  document.getElementById('renewalFlag').addEventListener('change', updateRenewUI);

  // 메인 키워드 입력 시 실시간 키워드 밀도 계산
  document.getElementById('field-mainKeyword').addEventListener('input', updateKeywordDensityInfo);
  document.getElementById('field-targetLength').addEventListener('change', updateKeywordDensityInfo);

  function getSelectedType() {
    const checked = document.querySelector('input[name="postType"]:checked');
    return checked ? checked.value : '하자 보수 사례';
  }

  function updateTypeUI() {
    const type = getSelectedType();
    const colSec = document.getElementById('section-column');
    const faqSec = document.getElementById('section-faq');
    const basicSec = document.getElementById('section-basic');
    const probSec = document.getElementById('section-problem');
    const procSec = document.getElementById('section-process');
    const photoSec = document.getElementById('section-photos');
    const extraSec = document.getElementById('section-extra');
    const dgSec = document.getElementById('section-danggeun');
    const renewSec = document.getElementById('renewSection');

    const normalSections = [basicSec, probSec, procSec, photoSec, extraSec];

    if (type === '당근 변환') {
      normalSections.forEach(sec => { if (sec) sec.style.display = 'none'; });
      if (colSec) colSec.style.display = 'none';
      if (faqSec) faqSec.style.display = 'none';
      if (dgSec) dgSec.style.display = 'block';
      if (renewSec) renewSec.style.display = 'none';
    } else {
      normalSections.forEach(sec => { if (sec) sec.style.display = 'block'; });
      if (dgSec) dgSec.style.display = 'none';

      if (type === '블로그 칼럼') {
        if (colSec) colSec.style.display = 'block';
        if (faqSec) faqSec.style.display = 'none';
      } else if (type === '자주 묻는 질문') {
        if (colSec) colSec.style.display = 'none';
        if (faqSec) faqSec.style.display = 'block';
      } else {
        if (colSec) colSec.style.display = 'none';
        if (faqSec) faqSec.style.display = 'none';
      }

      updateRenewUI();
    }

    // 품질 점수 초기화
    resetQualityScores();
  }

  function updateRenewUI() {
    const flag = document.getElementById('renewalFlag').checked;
    const sec = document.getElementById('renewSection');
    const type = getSelectedType();
    if (!sec) return;

    if (type === '당근 변환') {
      sec.style.display = 'none';
      return;
    }

    sec.style.display = flag ? 'block' : 'none';
  }

  function toggleAdvanced() {
    const content = document.getElementById('advanced-content');
    const toggle = document.querySelector('.toggle-section');
    
    if (content.classList.contains('hidden')) {
      content.classList.remove('hidden');
      toggle.classList.remove('collapsed');
    } else {
      content.classList.add('hidden');
      toggle.classList.add('collapsed');
    }
  }

  // ============================================
  // 🎯 PART 2: 고급 SEO 함수들
  // ============================================

  /**
   * 키워드 밀도 정확하게 계산
   * 한글 기준: 평균 2.5자당 1단어로 계산
   */
  function calculateKeywordDensity(textLength, targetDensity = 2.0) {
    const wordCount = Math.floor(textLength / 2.5);
    const keywordCount = Math.ceil(wordCount * (targetDensity / 100));
    
    return {
      minCount: Math.max(1, keywordCount - 1),
      maxCount: keywordCount + 1,
      targetDensity: targetDensity,
      wordCount: wordCount
    };
  }

  /**
   * 실시간 키워드 밀도 정보 업데이트
   */
  function updateKeywordDensityInfo() {
    const mainKeyword = document.getElementById('field-mainKeyword').value.trim();
    const targetLength = parseInt(document.getElementById('field-targetLength').value);
    const densityTarget = parseFloat(document.getElementById('field-keywordDensity').value);
    
    const info = document.getElementById('keyword-density-info');
    const recommendation = document.getElementById('keyword-recommendation');
    
    if (mainKeyword && targetLength) {
      const density = calculateKeywordDensity(targetLength, densityTarget);
      
      info.style.display = 'block';
      recommendation.innerHTML = `
        <strong>${targetLength}자 기준</strong><br>
        • 예상 단어 수: 약 ${density.wordCount}개<br>
        • <strong style="color:#27AE60;">'${mainKeyword}'</strong> 사용 권장 횟수: <strong style="color:#e74c3c;">${density.minCount}~${density.maxCount}회</strong><br>
        • 목표 밀도: ${density.targetDensity}%
      `;
      
      // AI 키워드 제안
      generateAIKeywordSuggestion(mainKeyword);
    } else {
      info.style.display = 'none';
    }
  }

  /**
   * LSI 키워드 생성 (개선된 버전)
   */
  function generateLSIKeywords(mainKeyword) {
    const lsiMap = {
      '욕실타일보수': ['욕실수리', '타일교체', '누수방지', '방수공사', '타일시공', '타일재시공', '하자보수'],
      '욕실타일': ['욕실타일보수', '욕실수리', '타일교체', '타일크랙', '타일들뜸', '타일파손'],
      '타일크랙': ['타일균열', '타일들뜸', '타일파손', '하자보수', '부분교체', '타일보수'],
      '타일하자': ['타일크랙', '타일들뜸', '타일파손', '하자보수', '부분시공', '타일수리'],
      '집수리': ['인테리어보수', '리모델링', '하자보수', '부분시공', '보수공사', '주택수리'],
      '문틀보수': ['문틀교체', '문선수리', '목재보수', '썩은문틀', '문짝보수', '문틀썩음'],
      '실리콘': ['실리콘보수', '실리콘교체', '곰팡이제거', '실리콘재시공', '코킹작업'],
      '욕실리모델링': ['욕실공사', '욕실인테리어', '화장실리모델링', '욕실수리', '욕실타일'],
      '베란다': ['베란다타일', '베란다누수', '발코니타일', '베란다확장', '베란다방수'],
      '누수': ['누수수리', '누수방지', '방수공사', '물새는곳', '누수탐지'],
      '곰팡이': ['곰팡이제거', '곰팡이방지', '습기제거', '결로방지', '환기'],
      '몰딩': ['몰딩교체', '걸레받이', '마감재', '인테리어몰딩', '틈새보수']
    };

    // 부분 매칭 로직
    for (let key in lsiMap) {
      if (mainKeyword.includes(key) || key.includes(mainKeyword.replace(/\s/g, ''))) {
        return lsiMap[key];
      }
    }

    // 지역명 제거 후 재시도
    const keywordWithoutRegion = mainKeyword.replace(/(평택|오산|화성|동탄|수원|안성|서울|경기|인천)/g, '').trim();
    for (let key in lsiMap) {
      if (keywordWithoutRegion.includes(key) || key.includes(keywordWithoutRegion)) {
        return lsiMap[key];
      }
    }

    // 기본값
    return ['시공', '보수', '수리', '교체', '하자', '공사'];
  }

  /**
   * 계절별 키워드 고도화 버전
   */
  function getSeasonalKeywords() {
    const month = new Date().getMonth() + 1;
    
    const seasonalData = {
      spring: {
        months: [3, 4, 5],
        keywords: ['봄철리모델링', '환기', '곰팡이예방', '미세먼지차단', '황사대비', '봄이사', '새학기'],
        urgency: '리모델링 시즌',
        trends: ['신혼집인테리어', '이사준비', '봄맞이정리'],
        reason: '봄은 환기가 잘 되고 공사 조건이 좋아 리모델링 최적기'
      },
      summer: {
        months: [6, 7, 8],
        keywords: ['장마누수', '습기제거', '결로방지', '곰팡이제거', '방수공사', '장마대비', '누수점검'],
        urgency: '누수 긴급',
        trends: ['베란다확장', '욕실방수', '장마철관리'],
        reason: '장마철 누수 문제가 가장 많이 발생하는 시기'
      },
      fall: {
        months: [9, 10, 11],
        keywords: ['가을시공', '겨울준비', '단열공사', '보수공사', '난방효율', '월동준비', '가을이사'],
        urgency: '겨울 전 점검',
        trends: ['월동준비', '보일러교체', '가을공사'],
        reason: '겨울 전 하자를 미리 보수하는 것이 중요'
      },
      winter: {
        months: [12, 1, 2],
        keywords: ['동파방지', '결로해결', '난방효율', '단열보강', '겨울철관리', '보일러', '배관동파'],
        urgency: '동파 주의',
        trends: ['보일러점검', '배관동파', '결로해결'],
        reason: '동파와 결로 문제가 집중되는 시기'
      }
    };
    
    for (let season in seasonalData) {
      if (seasonalData[season].months.includes(month)) {
        return seasonalData[season];
      }
    }
    
    return seasonalData.spring; // 기본값
  }

  /**
   * 태그 최적화 (개선된 버전)
   */
  function optimizeTagPriority(type, location, mainKeyword) {
    const tags = new Set();
    
    // 1순위: 핵심 브랜드 태그
    tags.add('#수한공간타일');
    
    // 2순위: 지역 + 메인 키워드 조합 (3개)
    const region = extractRegion(location);
    if (region && mainKeyword) {
      tags.add(`#${region}${mainKeyword.replace(/\s/g, '')}`);
      tags.add(`#${region}타일보수`);
      tags.add(`#${region}집수리`);
    }
    
    // 3순위: 롱테일 키워드 (8개)
    const longTail = [
      '타일부분교체', '욕실타일들뜸', '거실타일보수', '베란다타일',
      '아파트타일', '문틀썩음', '몰딩교체', '실리콘곰팡이'
    ];
    longTail.slice(0, 8).forEach(kw => tags.add(`#${kw}`));
    
    // 4순위: 문제 해결형 태그 (5개)
    const problemTags = ['타일크랙수리', '누수해결', '곰팡이제거', '하자보수', '긴급수리'];
    problemTags.forEach(tag => tags.add(`#${tag}`));
    
    // 5순위: 지역 확장 태그 (3개)
    const nearbyRegions = getNearbyRegions(region);
    nearbyRegions.slice(0, 3).forEach(r => tags.add(`#${r}인테리어`));
    
    // 6순위: 계절/트렌드 태그 (2개)
    const seasonal = getSeasonalKeywords();
    seasonal.keywords.slice(0, 2).forEach(kw => tags.add(`#${kw}`));
    
    // 7순위: LSI 키워드 태그 (2개)
    const lsi = generateLSIKeywords(mainKeyword);
    lsi.slice(0, 2).forEach(kw => tags.add(`#${kw}`));
    
    return Array.from(tags).slice(0, 25);
  }

  /**
   * 지역명 추출
   */
  function extractRegion(location) {
    const regions = ['평택', '오산', '화성', '동탄', '수원', '안성', '서울', '경기', '인천'];
    for (let region of regions) {
      if (location.includes(region)) {
        return region;
      }
    }
    return '평택'; // 기본값
  }

  /**
   * 인근 지역 추출
   */
  function getNearbyRegions(region) {
    const regionMap = {
      '평택': ['오산', '화성', '안성'],
      '오산': ['평택', '화성', '수원'],
      '화성': ['평택', '오산', '동탄'],
      '동탄': ['화성', '수원', '오산'],
      '수원': ['오산', '화성', '용인'],
      '안성': ['평택', '용인', '이천']
    };
    
    return regionMap[region] || ['오산', '화성', '수원'];
  }

  /**
   * AI 키워드 제안 생성
   */
  function generateAIKeywordSuggestion(mainKeyword) {
    const suggestion = document.getElementById('ai-keyword-suggestion');
    const text = document.getElementById('ai-keyword-text');
    
    const lsi = generateLSIKeywords(mainKeyword);
    const seasonal = getSeasonalKeywords();
    
    suggestion.style.display = 'block';
    text.innerHTML = `
      <strong>연관 키워드:</strong> ${lsi.slice(0, 5).join(', ')}<br>
      <strong>계절 키워드:</strong> ${seasonal.keywords.slice(0, 3).join(', ')}<br>
      <strong>추천 이유:</strong> ${seasonal.reason}
    `;
  }

  // ============================================
  // 🎯 PART 3: 제목 생성 템플릿 시스템
  // ============================================

  /**
   * 제목 템플릿 생성 (3가지 버전)
   */
  function generateTitleTemplates(location, mainKeyword, problem) {
    const region = extractRegion(location);
    const problemShort = problem.substring(0, 15) + (problem.length > 15 ? '...' : '');
    
    const templates = {
      regional: [
        `${region} ${mainKeyword}, ${problemShort} 해결 사례`,
        `${region} ${location.split(' ')[1] || '지역'} ${mainKeyword} 전문 업체`,
        `${region} 주민이 선택한 ${mainKeyword} - 실제 후기`,
        `${region} ${mainKeyword} 가격은? 부분 시공으로 비용 절약`,
        `${region} ${mainKeyword}, 이렇게 하면 절반 가격으로 가능`
      ],
      problem: [
        `${problemShort} 방치하면 어떻게 될까? ${mainKeyword} 전문가 답변`,
        `${problemShort} 원인 3가지와 올바른 대처법`,
        `왜 ${problemShort}가 생길까? ${region} 전문가가 알려드립니다`,
        `${problemShort}, 전체 철거 없이 해결하는 방법`,
        `${problemShort} 겪고 계신가요? ${mainKeyword} 상담 사례`
      ],
      solution: [
        `${problemShort} → 부분 보수로 해결 (사진 비교)`,
        `반나절만에 끝낸 ${mainKeyword}, 이렇게 했습니다`,
        `${problemShort} 부분보수로 비용 50% 절약한 방법`,
        `${region} ${mainKeyword} 전후 비교 - 놀라운 변화`,
        `전체 철거 vs 부분 보수, ${mainKeyword} 현명한 선택은?`
      ]
    };
    
    return {
      versionA: selectRandom(templates.regional),
      versionB: selectRandom(templates.problem),
      versionC: selectRandom(templates.solution)
    };
  }

  function selectRandom(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }
// ============================================
  // 🎯 PART 4: 품질 점수 계산 시스템
  // ============================================

  /**
   * 전체 콘텐츠 품질 점수 계산
   */
  function calculateQualityScore() {
    const scores = {
      keywordOptimization: checkKeywordOptimization(),
      seoStructure: checkSEOStructure(),
      engagement: checkEngagementElements(),
      technical: checkTechnicalDetails(),
      completeness: checkCompleteness()
    };
    
    const totalScore = Math.round(
      (scores.keywordOptimization + scores.seoStructure + 
       scores.engagement + scores.technical + scores.completeness) / 5
    );
    
    // UI 업데이트
    document.getElementById('preview-keyword-score').textContent = scores.keywordOptimization;
    document.getElementById('preview-seo-score').textContent = scores.seoStructure;
    document.getElementById('preview-engagement-score').textContent = scores.engagement;
    document.getElementById('preview-total-score').textContent = totalScore;
    
    // 상세 분석 팝업
    showQualityAnalysis(scores, totalScore);
    
    return { scores, totalScore };
  }

  /**
   * 키워드 최적화 점수 (0-100)
   */
  function checkKeywordOptimization() {
    let score = 0;
    
    const mainKeyword = document.getElementById('field-mainKeyword').value.trim();
    const subKeyword = document.getElementById('field-subKeyword').value.trim();
    const location = document.getElementById('field-location').value.trim();
    
    // 메인 키워드 존재 (30점)
    if (mainKeyword.length >= 3) score += 30;
    
    // 지역 키워드 포함 (25점)
    if (location.length >= 2) score += 25;
    
    // 보조 키워드 존재 (15점)
    if (subKeyword.length >= 2) score += 15;
    
    // 키워드 길이 적절성 (15점)
    if (mainKeyword.length >= 5 && mainKeyword.length <= 15) score += 15;
    
    // LSI 키워드 가능성 (15점)
    const lsi = generateLSIKeywords(mainKeyword);
    if (lsi.length >= 5) score += 15;
    
    return Math.min(100, score);
  }

  /**
   * SEO 구조 점수 (0-100)
   */
  function checkSEOStructure() {
    let score = 0;
    
    const problem = document.getElementById('field-problem').value.trim();
    const process = document.getElementById('field-process').value.trim();
    const photos = document.getElementById('field-photos').value.trim();
    const material = document.getElementById('field-material').value.trim();
    
    // 문제 정의 (25점)
    if (problem.length >= 20) score += 25;
    
    // 프로세스 설명 (25점)
    if (process.length >= 30) score += 25;
    
    // 사진 설명 (25점)
    if (photos.length >= 50) score += 25;
    
    // 기술 상세 (25점)
    if (material.length >= 20) score += 25;
    
    return Math.min(100, score);
  }

  /**
   * 참여도 유도 점수 (0-100)
   */
  function checkEngagementElements() {
    let score = 40; // 기본 점수
    
    const fear = document.getElementById('field-fear').value.trim();
    const point = document.getElementById('field-point').value.trim();
    const extra = document.getElementById('field-extra').value.trim();
    const cause = document.getElementById('field-cause').value.trim();
    
    // 고객 걱정 공감 (15점)
    if (fear.length >= 15) score += 15;
    
    // 강조 포인트 (15점)
    if (point.length >= 15) score += 15;
    
    // 추가 스토리 (15점)
    if (extra.length >= 10) score += 15;
    
    // 원인 분석 (15점)
    if (cause.length >= 15) score += 15;
    
    return Math.min(100, score);
  }

  /**
   * 기술적 상세도 점수 (0-100)
   */
  function checkTechnicalDetails() {
    let score = 30; // 기본 점수
    
    const material = document.getElementById('field-material').value.trim();
    const duration = document.getElementById('field-duration').value.trim();
    const point = document.getElementById('field-point').value.trim();
    
    // 자재 설명 상세도 (30점)
    if (material.length >= 50) score += 20;
    else if (material.length >= 30) score += 10;
    
    // 작업 시간 명시 (20점)
    if (duration.length >= 3) score += 20;
    
    // 기술 포인트 (20점)
    if (point.length >= 30) score += 15;
    else if (point.length >= 15) score += 10;
    
    // 전문 용어 사용 체크 (10점)
    const technicalTerms = ['몰탈', '접착제', '방수', '실리콘', '퍼티', '코킹', '우레탄', '평탄', '구배'];
    let termCount = 0;
    technicalTerms.forEach(term => {
      if (material.includes(term) || point.includes(term)) termCount++;
    });
    if (termCount >= 3) score += 10;
    
    return Math.min(100, score);
  }

  /**
   * 완성도 점수 (0-100)
   */
  function checkCompleteness() {
    let score = 0;
    let filledFields = 0;
    const totalFields = 10;
    
    const fields = [
      'field-location',
      'field-mainKeyword',
      'field-problem',
      'field-process',
      'field-duration',
      'field-material',
      'field-point',
      'field-photos',
      'field-fear',
      'field-extra'
    ];
    
    fields.forEach(fieldId => {
      const field = document.getElementById(fieldId);
      if (field && field.value.trim().length > 0) {
        filledFields++;
      }
    });
    
    score = Math.round((filledFields / totalFields) * 100);
    
    return score;
  }

  /**
   * 품질 분석 결과 표시
   */
  function showQualityAnalysis(scores, totalScore) {
    let grade = '';
    let gradeColor = '';
    let message = '';
    
    if (totalScore >= 90) {
      grade = 'S급 (상위 1%)';
      gradeColor = '#FFD700';
      message = '🎉 완벽합니다! 네이버 상위 노출 가능성이 매우 높습니다.';
    } else if (totalScore >= 80) {
      grade = 'A급 (상위 5%)';
      gradeColor = '#27AE60';
      message = '✅ 우수합니다! 몇 가지만 보완하면 완벽합니다.';
    } else if (totalScore >= 70) {
      grade = 'B급 (상위 15%)';
      gradeColor = '#3498DB';
      message = '👍 양호합니다. 아래 개선사항을 참고하세요.';
    } else if (totalScore >= 60) {
      grade = 'C급 (평균)';
      gradeColor = '#F39C12';
      message = '⚠️ 평균 수준입니다. 더 많은 정보를 입력해주세요.';
    } else {
      grade = 'D급';
      gradeColor = '#E74C3C';
      message = '❌ 필수 항목들을 더 채워주세요.';
    }
    
    // 개선 제안
    const improvements = [];
    if (scores.keywordOptimization < 80) improvements.push('• 메인 키워드와 지역명을 더 명확히 입력하세요');
    if (scores.seoStructure < 80) improvements.push('• 작업 과정과 사진 설명을 더 상세히 작성하세요');
    if (scores.engagement < 80) improvements.push('• 고객의 걱정사항과 강조 포인트를 추가하세요');
    if (scores.technical < 80) improvements.push('• 사용 자재와 기술적 디테일을 더 자세히 설명하세요');
    if (scores.completeness < 80) improvements.push('• 비어있는 항목들을 채워주세요');
    
    const improvementText = improvements.length > 0 
      ? `\n\n📋 개선 제안:\n${improvements.join('\n')}`
      : '\n\n✨ 모든 항목이 우수합니다!';
    
    alert(`
📊 콘텐츠 품질 분석 결과

🏆 종합 등급: ${grade}
📈 종합 점수: ${totalScore}점

${message}

━━━━━━━━━━━━━━━━
📊 세부 점수:
- 키워드 최적화: ${scores.keywordOptimization}점
- SEO 구조: ${scores.seoStructure}점
- 참여도 유도: ${scores.engagement}점
- 기술 상세도: ${scores.technical}점
- 완성도: ${scores.completeness}점
${improvementText}
    `);
  }

  /**
   * 초기 점수 리셋
   */
  function resetQualityScores() {
    document.getElementById('preview-keyword-score').textContent = '-';
    document.getElementById('preview-seo-score').textContent = '-';
    document.getElementById('preview-engagement-score').textContent = '-';
    document.getElementById('preview-total-score').textContent = '-';
  }

  // ============================================
  // 🎯 PART 5: 키워드 심층 분석
  // ============================================

  /**
   * 키워드 심층 분석 + 경쟁사 전략
   */
  function showKeywordAnalysis() {
    const mainKeyword = document.getElementById('field-mainKeyword').value.trim();
    const location = document.getElementById('field-location').value.trim();
    const competition = document.getElementById('field-competition').value;
    
    if (!mainKeyword) {
      alert('❌ 메인 키워드를 먼저 입력해주세요.');
      return;
    }
    
    const region = extractRegion(location);
    const lsi = generateLSIKeywords(mainKeyword);
    const seasonal = getSeasonalKeywords();
    const targetLength = parseInt(document.getElementById('field-targetLength').value);
    const density = calculateKeywordDensity(targetLength, 2.0);
    
    // 경쟁 전략
    let competitionStrategy = '';
    if (competition === 'high') {
      competitionStrategy = `
🔥 높은 경쟁 키워드 전략:
- 롱테일 키워드 집중 (예: ${region} ${mainKeyword} 부분시공 후기)
- 구체적 지역명 강조 (동 단위까지 명시)
- 실제 사례와 가격 정보로 차별화
- 최소 1500자 이상 상세한 글 작성
- 사진 10장 이상 + Before/After 비교
      `;
    } else if (competition === 'medium') {
      competitionStrategy = `
⚖️ 중간 경쟁 키워드 전략:
- 메인 키워드 + 지역명 조합
- LSI 키워드 5개 이상 자연스럽게 배치
- 1200자 이상 작성
- 사진 7~10장
- 고객 후기와 전문가 조언 포함
      `;
    } else {
      competitionStrategy = `
🎯 낮은 경쟁 키워드 전략:
- 롱테일 키워드로 빠른 상위 노출 가능
- 800~1000자만으로도 충분
- 핵심 키워드 반복보다 자연스러운 흐름 중시
- 사진 5~7장
- 문제 해결 중심 콘텐츠
      `;
    }
    
    // 경쟁사 차별화 전략
    const differentiationStrategies = [
      `✅ "전체 철거 vs 부분 보수" 비교 차트 제공`,
      `✅ 실제 작업 과정을 단계별 사진으로 상세 설명`,
      `✅ 사용 자재 브랜드명과 선택 이유 명시`,
      `✅ 공사 기간과 소음 수준 정직하게 안내`,
      `✅ 비용 절감 방법 구체적으로 제시`,
      `✅ A/S 정책과 사후 관리 방법 명시`,
      `✅ 계절별 관리 팁 추가로 제공`
    ];
    
    const analysis = `
━━━━━━━━━━━━━━━━━━━━━━━
🔍 키워드 심층 분석 리포트
━━━━━━━━━━━━━━━━━━━━━━━

📌 메인 키워드: ${mainKeyword}
📍 타겟 지역: ${region} ${location}
⚔️ 경쟁 강도: ${competition === 'high' ? '높음' : competition === 'medium' ? '보통' : '낮음'}

━━━━━━━━━━━━━━━━━━━━━━━
📊 SEO 최적화 수치

- 목표 글자 수: ${targetLength}자
- 예상 단어 수: ${density.wordCount}개
- '${mainKeyword}' 권장 사용: ${density.minCount}~${density.maxCount}회
- 키워드 밀도 목표: ${density.targetDensity}%

━━━━━━━━━━━━━━━━━━━━━━━
🔗 LSI 연관 키워드 (${lsi.length}개 필수 포함)

${lsi.slice(0, 7).map((kw, i) => `${i+1}. ${kw}`).join('\n')}

💡 이 키워드들을 본문에 자연스럽게 3~5회 배치하세요.

━━━━━━━━━━━━━━━━━━━━━━━
🌸 계절 키워드 (${new Date().getMonth() + 1}월 기준)

${seasonal.keywords.slice(0, 5).map((kw, i) => `${i+1}. ${kw}`).join('\n')}

📅 시즌 특성: ${seasonal.urgency}
💬 활용 TIP: ${seasonal.reason}

━━━━━━━━━━━━━━━━━━━━━━━
${competitionStrategy}

━━━━━━━━━━━━━━━━━━━━━━━
🎯 경쟁사 차별화 전략

${differentiationStrategies.join('\n')}

━━━━━━━━━━━━━━━━━━━━━━━
📈 추가 최적화 TIP

1️⃣ 제목에 숫자 포함 (예: "3가지 방법", "50% 절감")
2️⃣ 첫 문단에 지역명 + 문제 + 해결 모두 언급
3️⃣ 소제목마다 키워드 1회씩 포함
4️⃣ 마지막 문단에 행동 유도 (전화, 상담, 견적)
5️⃣ 태그 25개 모두 활용 (롱테일 중심)

━━━━━━━━━━━━━━━━━━━━━━━
✅ 이 분석 결과를 참고하여 프롬프트를 생성하면
   네이버 검색 상위 5% 진입이 가능합니다!
    `;
    
    alert(analysis);
    
    // 콘솔에도 출력 (복사 편의)
    console.log(analysis);
  }

  // ============================================
  // 🎯 PART 6: 공통 클립보드 헬퍼
  // ============================================

  function copyToClipboard(text, successMsg, fallbackMsg) {
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(text)
        .then(function () {
          alert(successMsg);
        })
        .catch(function () {
          fallbackCopy();
        });
    } else {
      fallbackCopy();
    }

    function fallbackCopy() {
      try {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.top = '-9999px';
        textarea.style.left = '-9999px';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.focus();
        textarea.select();

        const ok = document.execCommand && document.execCommand('copy');
        document.body.removeChild(textarea);

        if (ok) {
          alert(successMsg + "\n\n※ 만약 붙여넣기가 안 되면, 다시 한 번 시도하거나 새 창 복사 방식을 사용해주세요.");
        } else {
          openPromptWindow();
        }
      } catch (e) {
        openPromptWindow();
      }
    }

    function openPromptWindow() {
      const win = window.open('', '_blank');
      if (!win || win.closed || typeof win.closed === 'undefined') {
        alert(fallbackMsg || '자동 복사가 어려운 환경입니다.\n\n팝업 차단이 되어 있을 수 있습니다.\n필요하다면 브라우저에서 팝업 허용 후 다시 시도해주세요.');
        return;
      }

      const escaped = text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');

      win.document.write(
        '<!DOCTYPE html>' +
        '<html lang="ko"><head>' +
        '<meta charset="UTF-8" />' +
        '<meta name="viewport" content="width=device-width, initial-scale=1.0" />' +
        '<title>프롬프트 수동 복사</title>' +
        '</head><body style="margin:0;padding:16px;font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;background:#f8f9fa;">' +
        '<h2 style="font-size:20px;margin-bottom:12px;color:#0A47A1;">📋 프롬프트 수동 복사</h2>' +
        '<p style="font-size:14px;color:#555;margin-bottom:12px;">아래 박스를 <strong>길게 눌러 전체 선택 → 복사</strong> 해서 ChatGPT에 붙여넣어 주세요.</p>' +
        '<textarea readonly style="width:100%;height:75vh;font-size:13px;white-space:pre-wrap;padding:12px;border:2px solid #c7d2fe;border-radius:8px;font-family:monospace;">' +
        escaped +
        '</textarea>' +
        '<p style="font-size:12px;color:#888;margin-top:12px;text-align:center;">복사 후 이 창을 닫으셔도 됩니다.</p>' +
        '</body></html>'
      );
      win.document.close();
    }
  }

  // 초기 설정
  updateTypeUI();
  updateRenewUI();
  resetQualityScores();

  // ============================================
  // 🎯 PART 7: 메인 프롬프트 빌드 함수
  // ============================================

  function buildPrompt() {
    const type = getSelectedType();

    if (type === '당근 변환') {
      buildDanggeunPrompt();
      return;
    }

    const isRenewal = document.getElementById('renewalFlag').checked;

    // 기본 정보 수집
    const loc = document.getElementById('field-location').value.trim() || '미입력';
    const mainKeyword = document.getElementById('field-mainKeyword').value.trim() || '미입력';
    const subKeyword = document.getElementById('field-subKeyword').value.trim() || '미입력';
    const targetLength = document.getElementById('field-targetLength').value;
    const competition = document.getElementById('field-competition').value;
    
    const problem = document.getElementById('field-problem').value.trim() || '미입력';
    const fear = document.getElementById('field-fear').value.trim() || '미입력';
    const cause = document.getElementById('field-cause').value.trim() || '미입력';
    
    const process = document.getElementById('field-process').value.trim() || '미입력';
    const duration = document.getElementById('field-duration').value.trim() || '미입력';
    const material = document.getElementById('field-material').value.trim() || '미입력';
    const point = document.getElementById('field-point').value.trim() || '미입력';
    
    const photos = document.getElementById('field-photos').value.trim() || '미입력';
    const thumb = document.getElementById('field-thumbnail').value.trim() || '미입력';
    const extra = document.getElementById('field-extra').value.trim() || '미입력';
    const targetAudience = document.getElementById('field-targetAudience').value;

    // 리뉴얼 정보
    const renewTitle = document.getElementById('field-renewTitle').value.trim() || '미입력';
    const renewOriginal = document.getElementById('field-renewOriginal').value.trim() || '미입력';
    const renewChange = document.getElementById('field-renewChange').value.trim() || '미입력';

    // 칼럼/FAQ 정보
    const colTopic = document.getElementById('field-columnTopic').value.trim() || '미입력';
    const colAngle = document.getElementById('field-columnAngle').value.trim() || '미입력';
    const colTarget = document.getElementById('field-columnTarget').value.trim() || '미입력';

    const faqQ1 = document.getElementById('field-faqQ1').value.trim() || '미입력';
    const faqA1 = document.getElementById('field-faqA1').value.trim() || '미입력';
    const faqQ2 = document.getElementById('field-faqQ2').value.trim() || '미입력';
    const faqA2 = document.getElementById('field-faqA2').value.trim() || '미입력';
    const faqQ3 = document.getElementById('field-faqQ3').value.trim() || '미입력';
    const faqA3 = document.getElementById('field-faqA3').value.trim() || '미입력';

    // 고급 설정
    const keywordDensity = document.getElementById('field-keywordDensity').value;
    const lsiCount = document.getElementById('field-lsiCount').value;
    const abVersions = document.getElementById('field-abVersions').value;
    const includeCompetitor = document.getElementById('field-includeCompetitor').checked;
    const includeFAQ = document.getElementById('field-includeFAQ').checked;
    const includeStats = document.getElementById('field-includeStats').checked;
    const includeInternalLink = document.getElementById('field-includeInternalLink').checked;

    // 고급 SEO 데이터 생성
    const region = extractRegion(loc);
    const lsiKeywords = generateLSIKeywords(mainKeyword);
    const seasonalData = getSeasonalKeywords();
    const density = calculateKeywordDensity(parseInt(targetLength), parseFloat(keywordDensity));
    const tags = optimizeTagPriority(type, loc, mainKeyword);
    const titleTemplates = generateTitleTemplates(loc, mainKeyword, problem);

    // 경쟁 전략 텍스트
    let competitionStrategyText = '';
    if (competition === 'high') {
      competitionStrategyText = '높은 경쟁 키워드이므로 롱테일 키워드 집중, 최소 1500자 이상, 사진 10장 이상 필요';
    } else if (competition === 'medium') {
      competitionStrategyText = '중간 경쟁이므로 LSI 키워드 5개 이상 자연스럽게 배치, 1200자 이상 권장';
    } else {
      competitionStrategyText = '낮은 경쟁이므로 800~1000자로도 상위 노출 가능, 자연스러운 흐름 중시';
    }

    // V5 ULTIMATE 마스터 규칙 (기존과 동일하게 유지)
    const masterRules = `
[🚨 긴급 지침: '수한공간' 전속 페르소나 적용 — 네이버 블로그용 통합 마스터 프롬프트 V5 ULTIMATE]

당신은 지금부터 "수한공간 블로그 전문 컨설턴트 + 카피라이터 + SEO 알고리즘 전문가"입니다.  
아래 **수한공간 전용 페르소나 + 35개 통합 규칙(V5)** 을 100% 준수하여 네이버 블로그용 글을 작성하십시오.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[👤 수한공간 전용 페르소나 완전판]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

▪ 1) 브랜드·대표  
- 브랜드: 수한공간타일 (타일/욕실/집수리 전문)  
- 대표: 윤수한  
- 주요 서비스:  
  · 타일 하자 보수 (크랙, 들뜸, 파손)
  · 타일 부분 시공  
  · 욕실 리모델링  
  · 문틀/문선/몰딩/걸레받이/실리콘/곰팡이/누수 주변 보수  
  · 막방/철거/평탄화 시공  
- 영업 지역: 평택·오산·화성·동탄·수원·안성 및 인근 지역

▪ 2) 시공 철학  
- 전체 철거 강요 금지  
- "정확한 진단 → 정말 필요한 부분만 보수"  
- 기술적 근거 + 고객 안심  
- 투명한 공정 설명(방수, 바닥 구배, 배관, 접착제, 평탄클립 등)

▪ 3) 글 말투  
- 실제 시공자가 하루 작업 끝나고 차분하게 설명하는 말투  
- 과장/과한 영업/책 같은 말투 금지  
- 자연스러운 구어체, 전문가 포스는 유지  
- 문단은 3~6줄 / 7줄 이상 금지  
- 문단 사이에 반드시 **엔터 두 번(빈 줄 1개)**

▪ 4) 기술 수준  
- 접착제(세라픽스/유니픽스/압착/아딕스/드라이픽스)  
- 평탄화 / 막방 / 배관 / 온수온돌 / 실리콘 / 방수 / 목재부식 / 곰팡이 / 문틀보수  
- 자재 선택 이유를 꼭 기술적으로 3~4줄 설명

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[📋 네이버 블로그 통합 규칙 35개 — V5 ULTIMATE]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

〔 기본 글쓰기 스타일 〕

◆ 1. 글쓰기 기본 스타일  
- 사람 말투 / 부드러운 전문 톤  
- 문제→원인→과정→결과 흐름  
- 반복 패턴·기계 말투 금지  
- 인사말 금지 ("안녕하세요" 등)

◆ 2. 문단/엔터 규칙  
- 문단: 3~6줄  
- 문단 사이: **엔터 두 번(빈 줄 한 줄)**  
- 긴 문단 금지(7줄 이상)

◆ 3. 소제목 규칙(19px 적용 전제)  
- 이모지 1개 + 한 줄 완성형 문장  
- 소제목 위·아래 빈 줄  
- 네이버에서 사용자가 직접 19px·굵게·파란색 적용  
- **소제목에도 지역명 + 핵심 키워드 포함**  
- 길이: 10~25자  
예)  
❌ "🔧 문제 상황 정리"  
✅ "🔧 평택 욕실 타일 크랙, 원인은 이것이었습니다"

◆ 4. 이모지 규칙  
- 전체 글 3–6개  
- 소제목 위주로 사용  
- 도배 금지

〔 제목 최적화 〕

◆ 5. 제목 규칙 (A/B/C 3가지 버전 생성)  
- ① 지역 기반형: "${region} ${mainKeyword}, ${problem} 해결 사례"
- ② 문제·질문형: "${problem} 방치하면 어떻게 될까? 전문가 답변"
- ③ 해결·전후 변화형: "${problem} → 부분 시공으로 해결 (사진 비교)"
- 3개를 서로 다르게 생성  
- 제목 키워드 3개는 본문 첫 3문단 안에 모두 등장

◆ 6. 제목 고급 TIP
- 숫자 포함 (예: "3가지 방법", "50% 절감")
- 구체적 지역 (동 단위까지)
- 혜택 명시 ("비용 절약", "당일 해결")
- 클릭 유도 ("놀라운 변화", "이렇게 했습니다")

〔 SEO 핵심 전략 〕

◆ 7. 지역 키워드 전략  
- 전체 문단의 60~70%에 자연스럽게 지역명 포함  
- 중복 반복 금지  
- 계절 키워드 1~2회 포함  
  (예: 장마·결로·곰팡이·겨울 단열·습기 등)

◆ 8. SEO – C-Rank 최적화 (정밀 버전)
- 메인 키워드 밀도: ${keywordDensity}%  
  · ${targetLength}자 기준: **${density.minCount}~${density.maxCount}회 사용**
  · 예상 단어 수: 약 ${density.wordCount}개
- **LSI 키워드(연관어) 반드시 포함**: ${lsiKeywords.slice(0, parseInt(lsiCount)).join(', ')}
- 제목-본문 키워드 일치율 80% 이상  
- 검색되는 표현 삽입: 방문, 사진, 상태 확인, 문의 등

◆ 9. 키워드 배치 전략
- 첫 문단에 메인 키워드 1회 필수
- 각 소제목에 키워드 또는 LSI 키워드 1회
- 마지막 문단에 메인 키워드 1회
- 자연스럽게 분산 배치 (한 문단에 2회 이상 금지)

◆ 10. 체류시간 증가 전략  
- 글 후반부(70~80% 지점)에 핵심 팁  
- "마지막으로 많이 물어보시는 질문" 섹션 ${includeFAQ ? '필수 포함 (1~2개)' : ''}
- 수치 사용: "10년 현장에서 70%는…" 등 ${includeStats ? '필수 포함' : ''}
${includeInternalLink ? '- 내부 링크 제안: 본문 80% 지점에 "이전에 다룬 [관련 주제] 글에서 조금 더 자세히 정리해 두었습니다." 형식' : ''}

◆ 11. 경쟁사 차별화 문장  
${includeCompetitor ? `- 본문에 1회 필수 포함  
예)  
"다른 업체들은 전체 철거를 권해도,  
저희는 상태를 먼저 진단한 뒤 정말 필요한 부분만 보수로 안내드립니다."` : ''}

〔 콘텐츠 구조 〕

◆ 12. 네이버 카테고리 추천  
- 시공 사례 / 타일·욕실 노하우 / 집수리 팁 / 고객 Q&A / 계절별 관리 / 하자 진단

◆ 13. 사진·ALT 규칙  
- 본문에는 아래 형식만 표기  
  ▢ 사진: 설명(20~35자)  
- ALT 리스트는 본문 맨 아래에 따로 생성  
- 파일명: region_space_issue_step_01.jpg  
- step: before / remove / progress / after  
- 사진 순서: 시공 전→원인→중→후  
- 쓰지 말 것: 구분선(---), HTML 스타일 태그

◆ 14. 사진 개수  
- 하자보수: 5~8장  
- 부분시공: 8~12장  
- 욕실리모델링: 12~20장  
- 집수리: 4~7장  
- 칼럼/FAQ: 3~5장

◆ 15. 기술 전문성 반영  
- "왜 이 자재를 쓰는가"  
- "이 공정이 왜 중요한가"  
- 방수·구배·동공·크랙·들뜸·퍼티보수·문틀 부식 등 실제 현장 기준 설명

◆ 16. 신뢰도 문장(1~2개 필수)  
- "현장에서 보면 겉으로 안 보이던 문제가 종종 있습니다."  
- "걱정하실 수 있지만 실제로는 이렇게 해결됩니다."

◆ 17. 문의 유도 문장 – 고정  
📞 수한공간 출장 시공 문의  
(원본 문의 문구 그대로 사용)

◆ 18. 지도 문구 – 고정  
"저희는 고객님이 계신 곳으로 직접 방문하여 시공합니다. 아래 지도에서 활동 지역과 고객 후기를 확인하세요."

◆ 19. 동영상 위치 표기  
- "동영상: 시공 마감 장면(15초)" 형식으로 텍스트 표기

〔 태그 & 메타데이터 〕

◆ 20. 태그 생성 규칙(총 25개) – V5 최적화판  
우선순위별 구성:
1순위: #수한공간타일 (고정)
2순위: 지역+서비스 조합 3개 (예: #${region}${mainKeyword}, #${region}타일보수, #${region}집수리)
3순위: 롱테일 키워드 8개
4순위: 문제 해결형 5개
5순위: 지역 확장 3개
6순위: 계절/트렌드 2개
7순위: LSI 키워드 2개

**자동 생성 태그 샘플:**
${tags.slice(0, 25).join(' ')}

- 1음절 태그, 띄어쓰기 태그, 너무 긴 태그 금지  

〔 글 구조 & 분량 〕

◆ 21. 본문 기본 구조(기승전결)  
1) 문제 제시  
2) 상태 진단  
3) 해결 과정  
4) 결과 + 관리 팁

◆ 22. 글 유형별 분량  
- 하자 보수: 800~1200자  
- 부분 시공: 1200~1500자  
- 욕실 리모델링: 2000자 이상  
- 집수리: 800~1200자  
- 칼럼: 1500~1800자  
- FAQ: 1000~1200자

◆ 23. 모바일 최적화  
- 문장 최대 40자(50자 이상 금지)  
- 2~3문단마다 사진 배치  
- 소제목 3~4문단마다 배치  
- 첫 3줄 안에 지역+문제+해결 포함

◆ 24. FAQ 스키마 스타일  
- Q: 질문  
- A: 답변  
- 3개 이상 구성 시 명확한 구분

〔 계절 & 트렌드 〕

◆ 25. 계절별 키워드  
- 봄·가을: 환기/곰팡이 예방  
- 여름: 장마/누수/습기  
- 겨울: 결로/난방/단열  
→ 글 안에 1~2회 포함

**현재 계절 정보 (${new Date().getMonth() + 1}월):**
- 긴급도: ${seasonalData.urgency}
- 추천 키워드: ${seasonalData.keywords.slice(0, 5).join(', ')}
- 활용 이유: ${seasonalData.reason}

〔 리뉴얼(세탁) 모드 〕

◆ 26. 리뉴얼 전용 규칙
${isRenewal ? `
**※ 이 요청은 [리뉴얼] 모드입니다.**

필수 준수사항:
- 구조 100% 새로 작성
- 문장 표현 70% 이상 변화
- 동의어 사용 (보수→수리/복구, 시공→작업/공사 등)
- 사진 설명 전부 재작성
- 태그 50% 이상 교체
- 첫 문단 완전 교체
- 제목 완전 변경

⚠️ 중요: 사진 재사용 시 1~2mm 크롭 또는 밝기 조절 등 간단한 보정 필수

중복 판단 회피 안내문 반드시 출력:
"※ 기존 사진을 재사용하실 경우, 반드시 1~2mm 크롭, 밝기 조절, 채도 조정 등 간단한 보정을 해주셔야 이미지 중복 판정 위험을 줄일 수 있습니다."
` : '- 리뉴얼 아님 (신규 작성)'}

〔 A/B 테스팅 〕

◆ 27. A/B/C 테스팅 버전
${parseInt(abVersions) >= 2 ? `
**${abVersions}가지 버전 생성 요청됨**

각 버전별 차별화:
- 버전 A: ${titleTemplates.versionA}
  첫 문단: 문제 중심 시작, 공감 강조
  
- 버전 B: ${titleTemplates.versionB}  
  첫 문단: 질문형 시작, 호기심 유발
  
${parseInt(abVersions) >= 3 ? `- 버전 C: ${titleTemplates.versionC}
  첫 문단: 결과 중심 시작, 해결 강조` : ''}

→ 각 버전마다 제목 + 첫 문단을 다르게 구성하되, 본문 핵심 내용은 동일하게 유지
` : '- 1개 버전만 생성'}

〔 고급 최적화 〕

◆ 28. 타겟 독자 맞춤
${targetAudience ? `
**타겟 독자: ${targetAudience}**
- 이 독자층의 주요 관심사와 고민을 반영
- 해당 독자가 공감할 수 있는 사례 언급
- 독자 맞춤형 행동 유도 (CTA)
` : '- 타겟 독자 미지정 (일반 독자 대상)'}

◆ 29. 경쟁 강도별 전략
**현재 키워드 경쟁 강도: ${competition === 'high' ? '높음' : competition === 'medium' ? '보통' : '낮음'}**
${competitionStrategyText}

◆ 30. 통계/수치 활용
${includeStats ? `
**통계 문장 필수 포함 (1회 이상)**
예시:
- "10년 경력상 약 70%는 이런 원인입니다."
- "실제로 5건 중 3건은 이런 패턴으로 진행됩니다."
- "평택 지역 의뢰 중 80%가 부분 보수로 해결됩니다."
` : ''}

◆ 31. 전문 용어 밸런스
- 전문 용어 사용 시 바로 쉬운 설명 추가
- 예: "드라이픽스(기존 타일 위에 바로 시공 가능한 특수 접착제)"
- 한 문단에 전문 용어 2개 이상 금지

◆ 32. 행동 유도 (CTA) 배치
- 본문 중간 (50% 지점): 상담 문의 자연스럽게 언급
- 본문 끝 (90% 지점): 명확한 행동 유도
  예: "사진 몇 장만 보내주시면 상태 확인 후 정확한 안내 드립니다."

◆ 33. 지역 SEO 강화
- 동 단위 지역명 2회 이상 언급
- 랜드마크 언급 (예: "◯◯아파트 근처", "◯◯역 인근")
- 인근 지역명 1회 언급 (예: "평택뿐 아니라 오산, 화성 지역도")

◆ 34. 이미지 최적화 가이드
- 각 사진마다 20~35자 설명
- Before/After는 같은 각도, 같은 조명에서 촬영 강조
- 클로즈업과 전체샷 적절히 배치

◆ 35. 최종 출력 순서  
1) 제목 ${abVersions}개 (A/B/C 버전)
2) 본문
3) 사진 파일명 + ALT 리스트
4) 태그 25개
${isRenewal ? '5) 리뉴얼 주의사항 안내문' : ''}
6) 네이버 발행 시 강조 가이드 (굵게/색상 적용 위치)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
👉 위 모든 규칙(V5 ULTIMATE)을 적용하여,  
네이버 블로그 상위 0.5% 품질 기준의 글을 작성하십시오.
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

    // 정보 블록 구성 (기존과 동일)
    const renewalNote = isRenewal ? `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ [리뉴얼 모드 활성화]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

이 요청은 **기존 글 세탁 및 재구성** 모드입니다.
기존 글·사진을 바탕으로 완전히 새 구조로 재작성해 주세요.

**리뉴얼 전용 정보:**
- 기존 글 제목: ${renewTitle}
- 기존 글 본문:
${renewOriginal}

- 추가/변경 요청 내용:
${renewChange}

**리뉴얼 필수 체크리스트:**
✅ 구조 100% 변경 (문단 순서 완전 재배치)
✅ 문장 70% 이상 다른 표현으로 재작성
✅ 동의어 적극 활용
✅ 사진 설명 전부 새로 작성
✅ 태그 13개 이상 교체
✅ 제목 완전 변경
✅ 첫 문단 완전 교체

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
` : "";

    let typeSpecificBlock = "";
    if (type === "블로그 칼럼") {
      typeSpecificBlock = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 [칼럼 전용 정보]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

- 칼럼 주제 한 줄 요약: ${colTopic}
- 전달하고 싶은 관점/메시지: ${colAngle}
- 주요 대상 독자: ${colTarget}

**칼럼 작성 가이드:**
- 정보 전달 중심 (시공 사례가 아닌 지식 공유)
- 독자 질문에 답하는 형식
- 실제 사례 1~2개 간략히 언급
- 실용적인 팁 3가지 이상 제공

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;
    } else if (type === "자주 묻는 질문") {
      typeSpecificBlock = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❓ [FAQ 전용 정보]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**질문 1:** ${faqQ1}
답변 방향: ${faqA1}

**질문 2:** ${faqQ2}
답변 방향: ${faqA2}

**질문 3:** ${faqQ3}
답변 방향: ${faqA3}

**FAQ 작성 가이드:**
- 각 질문마다 150~200자 답변
- 전문가 관점에서 명확하고 친절하게
- 추가 질문 유도하는 멘트 마지막에 추가
- Q: / A: 형식 명확히 구분

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;
    }

    const infoBlock = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 [오늘 작성할 글 정보 — 여기를 채워서 함께 전달하세요]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**기본 정보:**
- 유형: ${type}
- 목표 글자 수: ${targetLength}자
- 경쟁 강도: ${competition === 'high' ? '높음' : competition === 'medium' ? '보통' : '낮음'}
- 리뉴얼 여부: ${isRenewal ? "[리뉴얼] 기존 글 세탁 및 재구성 요청" : "신규 작성"}
${targetAudience ? `- 타겟 독자: ${targetAudience}` : ''}

**현장 정보:**
- 지역/현장: ${loc}
- 메인 키워드: ${mainKeyword}
- 보조 키워드: ${subKeyword}

**고객 상황:**
- 고객 문제: ${problem}
- 고객이 특히 걱정한 부분: ${fear}
- 문제 발생 예상 원인: ${cause}

**작업 정보:**
- 예상 작업 소요 시간: ${duration}
- 작업 과정 (큰 흐름): ${process}
- 사용 자재 및 공법: ${material}
- 강조 포인트: ${point}

**사진 정보:**
- 사진 설명 (시공 전/중/후): ${photos}
- 대표 사진(인네일) 후보 메모: ${thumb}

**추가 정보:**
- 추가로 꼭 들어갔으면 하는 내용: ${extra}

${typeSpecificBlock}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🤖 [AI 자동 생성 SEO 보조 정보]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**키워드 밀도 계산:**
- 목표 밀도: ${keywordDensity}%
- 예상 단어 수: ${density.wordCount}개
- '${mainKeyword}' 권장 사용: **${density.minCount}~${density.maxCount}회**

**LSI 연관 키워드 (${lsiCount}개 필수 포함):**
${lsiKeywords.slice(0, parseInt(lsiCount)).map((kw, i) => `${i+1}. ${kw}`).join('\n')}

**계절별 키워드 (${new Date().getMonth() + 1}월 기준):**
- 추천 키워드: ${seasonalData.keywords.slice(0, 5).join(', ')}
- 긴급도: ${seasonalData.urgency}
- 활용 이유: ${seasonalData.reason}

**제목 템플릿 제안 (A/B/C 테스트용):**
- 버전 A (지역 기반): ${titleTemplates.versionA}
- 버전 B (문제 중심): ${titleTemplates.versionB}
- 버전 C (해결 중심): ${titleTemplates.versionC}

**태그 우선순위 추천 샘플 (25개):**
${tags.join(' ')}

**체류시간 증가 전략:**
${includeInternalLink ? `- 내부 링크: 본문 ${Math.round(parseInt(targetLength) * 0.8)}자 지점에 배치` : ''}
${includeFAQ ? `- 미니 FAQ: 본문 하단에 1~2개 자동 생성` : ''}
${includeStats ? `- 통계 문장: "10년 경력상 70%는..." 형식으로 1회 이상` : ''}
${includeCompetitor ? `- 경쟁사 차별화: "다른 업체들은... 저희는..." 문장 1회` : ''}

**경쟁 전략:**
${competitionStrategyText}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

    const emphasisGuide = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ [네이버 발행 시 수동 강조 가이드]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ChatGPT가 생성한 글은 일반 텍스트입니다.
네이버 블로그에 붙여넣은 후, 아래 부분을 수동으로 강조하세요:

🔵 **파란색(#0A47A1) + 굵게:**
- 메인 키워드 "${mainKeyword}" (첫 등장 1회)
- 지역명 "${region}" (1~2회)
- 소제목 전체

🔴 **빨간색(#D13B3B) + 굵게:**
- 가격 관련 (있을 경우)
- 기간/긴급성
- 주의사항

💛 **노란색 형광펜:**
- 핵심 차별화 포인트
- 고객 혜택
- "부분 보수로 비용 절약" 같은 문구

**굵게만:**
- 자재명 (드라이픽스, 아딕스 등)
- 공법 용어
- 기술 용어

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 발행 전 체크리스트:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

☐ 메인 키워드 "${mainKeyword}" → 굵게 + 파란색 (1~2회)
☐ 지역명 "${region}" → 굵게 + 파란색
☐ 핵심 차별화 문구 → 형광펜 (노란색)
☐ 소제목 전체 → 19px + 굵게 + 파란색
☐ 가격/기간 관련 → 굵게 + 빨간색
☐ CTA 문구 → 굵게 + 주황색

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

const intentSection = getIntentPromptSection();

const finalPrompt = masterRules + "\n\n" + renewalNote + intentSection + infoBlock + emphasisGuide + `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚀 [최종 지시]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

위 수한공간 전용 페르소나 + 35가지 규칙(V5 ULTIMATE) + 자동 SEO 보조 정보를 완벽하게 적용하여,
네이버 블로그 상위 0.5% 수준의 전문 포스팅을 작성해 주세요.

**출력 형식:**
1. 제목 ${abVersions}개 (A/B/C 버전)
2. 본문 (규칙 준수)
3. 사진 파일명 + ALT 텍스트 리스트
4. 태그 25개
${isRenewal ? '5. 리뉴얼 주의사항 최종 안내' : ''}

**품질 체크리스트:**
✅ 첫 3문단에 지역명 + 메인 키워드 모두 포함
✅ 메인 키워드 ${density.minCount}~${density.maxCount}회 사용
✅ LSI 키워드 ${lsiCount}개 자연스럽게 배치
✅ 문단 3~6줄, 문단 사이 엔터 2번
✅ 소제목에 지역명 + 키워드 포함
✅ 기술적 디테일 3~4줄 상세 설명
✅ ${targetLength}자 목표 (±10% 허용)

이제 작성을 시작하세요! 🎯
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

    copyToClipboard(
      finalPrompt,
      `✅ V5 ULTIMATE 마스터 프롬프트가 복사되었습니다!

📊 생성된 콘텐츠 정보:
- 키워드 밀도: ${keywordDensity}% (${density.minCount}~${density.maxCount}회)
- LSI 키워드: ${lsiCount}개
- A/B 테스트: ${abVersions}가지 버전
- 목표 글자 수: ${targetLength}자
- 경쟁 강도: ${competition}

ChatGPT 대화창에 그대로 붙여넣기 하시면,
상위 0.5% 품질의 네이버 블로그 글이 생성됩니다.

💡 TIP: 생성 후 "네이버 발행 시 강조 가이드"를 참고하여
      굵게/색상을 수동으로 적용하세요!`,
      "프롬프트를 새 창으로 열지 못했습니다.\n필요하다면 이 페이지에서 직접 선택 후 복사해주세요."
    );
  }

  // 당근 변환 프롬프트 함수
  function buildDanggeunPrompt() {
    const blog = (document.getElementById('dg-blogInput').value || '').trim();
    const region = (document.getElementById('dg-region').value || '').trim() || '미입력 지역';
    const service = document.getElementById('dg-service').value || '타일 하자보수';
    const cta = (document.getElementById('dg-cta').value || '').trim() ||
      "채팅으로 사진 보내주시면 상태 보고 먼저 안내드립니다.";

    if (!blog || blog.length < 50) {
      alert('❌ 네이버 블로그 원문을 입력해주세요.\n최소 50자 이상 필요합니다.');
      return;
    }

    const dgPrompt = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[네이버 블로그 글 → 당근 비즈 소식 최적화 변환 프롬프트 V5]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

너는 '당근 비즈 소식' 전문 마케터이자 로컬 판매 글쓰기 최적화 전문가이다.
아래에 제공된 네이버 블로그 원문을 읽고, 당근 비즈 소식 기준에 맞게 완전히 새 글로 재작성한다.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📄 [원문 - 네이버 블로그 글]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

${blog}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 [당근 변환 필수 조건]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

〔 기본 규칙 〕

1️⃣ **글자 수: 350~700자** (필수)
   - 최소 350자 이상
   - 최대 700자 이하
   - 간결하고 핵심만

2️⃣ **문단 구성: 3~5개**
   - 첫 문단: 지역 + 문제 후킹 (1~2줄)
   - 중간 문단: 서비스 소개 + 특징 (2~3개)
   - 마지막 문단: CTA + 신뢰 요소

3️⃣ **첫 문장 강화 (15자 이내)**
   - 지역: "${region}"
   - 서비스: "${service}"
   - 형식: "[지역]에서 [문제] 겪으셨나요?"
   
   ✅ 좋은 예:
   - "${region}에서 욕실 타일 금 가셨나요?"
   - "${region} 타일 하자, 부분만 고칠 수 있어요"
   - "${region} 집수리 고민이신가요?"
   
   ❌ 나쁜 예:
   - "안녕하세요, 수한공간입니다"
   - "오늘은 타일 보수 이야기를 해볼까 합니다"

4️⃣ **업종 특성 명확히**
   - "${service}" 전문 업체임을 자연스럽게 강조
   - 지역 밀착형 서비스 언급

5️⃣ **블로그 스타일 제거**
   - 긴 설명, 스토리텔링 최소화
   - 핵심만 남김
   - 사진 언급 제거
   - 이미지/동영상 설명 제거

〔 구조 가이드 〕

📌 **1문단: 후킹 (2~3줄)**
   - 지역명 + 고객 고민을 한 줄 질문으로
   - 공감 포인트 제시
   
   예시:
   "${region}에서 욕실 타일 크랙 때문에 고민이신가요?
   전체 철거는 부담스럽고, 부분만 고칠 수 있을지 궁금하시죠?"

📌 **2문단: 서비스 소개 (3~4줄)**
   - 우리가 하는 일 3가지
   - 각 항목 1줄씩
   - 구체적 + 차별화
   
   예시:
   "저희는 ${region} 지역 ${service} 전문 업체입니다.
   
   ✅ 상태 진단 후 필요한 부분만 보수
   ✅ 전체 철거 없이 당일 시공 가능  
   ✅ 기존 타일 색상 최대한 매칭"

📌 **3문단: 시공 사례 or 고객 반응 (2~3줄)**
   - 구체적 숫자 포함 (예: "◯◯건 이상", "10년 경력")
   - 실제 사례 간단히 언급
   
   예시:
   "${region}에서 이미 ${service} 100건 이상 진행했습니다.
   대부분 반나절~하루 안에 작업 완료되고,
   부분 시공으로 비용 부담도 낮췄다는 후기 많이 받았어요."

📌 **4문단: 신뢰 요소 (1~2줄)**
   - 경력, 지역, 당일 방문 가능 등
   
   예시:
   "${region} 10년 경력, 당일 방문 가능합니다.
   상태 확인 후 정확한 견적 안내드려요."

📌 **5문단: CTA (1~2줄)**
   - 아래 문장을 자연스럽게 녹여서 포함:
   "${cta}"

〔 금지 사항 〕

❌ **가격 직접 명시 금지**
   - "5만원부터" ❌
   - "10만원에 해드립니다" ❌
   
   ✅ **대신 이렇게:**
   - "상태 확인 후 정확한 견적"
   - "부분 보수로 비용 부담 낮춤"
   - "현장 상태에 따라 달라질 수 있음"

❌ **과장 표현 금지**
   - "최고", "최저가", "1등", "보장" 등

❌ **직접적 요청 금지**
   - "전화주세요" ❌
   - "연락바랍니다" ❌
   - "지금 바로" ❌
   
   ✅ **대신 이렇게:**
   - "채팅으로 사진 보내주시면 상태 확인해드려요"
   - "궁금하신 점 있으면 편하게 물어보세요"

❌ **이모지 3개 이상 사용 금지**
   - 최대 2개까지만
   - 자연스러운 위치에만

❌ **반말 금지**
   - 존댓말 필수 ("~습니다", "~세요" 체)

❌ **ㅋㅋ, ㅎㅎ, !!, ~~ 등 가벼운 표현 금지**

〔 제목 생성 규칙 〕

당근 소식용 **제목 1개** 별도 생성:

**형식:**
[${region}] ${service} | 핵심혜택 or 문제해결

**예시:**
- [${region}] ${service} | 부분시공으로 비용절감
- [${region}] 욕실 타일 크랙 | 당일 방문 가능
- [${region}] 집수리 | 전체 철거 없이 해결

**규칙:**
- 길이: 25~35자
- 이모지 1개 허용 (🛠, 🔧, ✅ 중 택1)
- 지역명 대괄호로 강조
- 파이프(|) 구분자 사용

〔 해시태그 전략 〕

본문 하단에 **3~5개만** 추가:

예시:
#${region} #${service} #당일시공 #부분보수 #견적무료

**규칙:**
- 지역 태그 필수
- 서비스 태그 필수
- 차별화 태그 1~2개
- 혜택 태그 1개

〔 말투 & 톤 〕

✅ **"동네 이웃 사장님이 조용히 설명해주는 듯한 친근한 존댓말"**

- 전문성은 유지하되 딱딱하지 않게
- 설명조 아닌 대화조
- 고객 입장에서 공감
- 신뢰감 + 편안함

예시:
❌ "저희 업체는 고객 만족을 최우선으로 생각합니다"
✅ "${region}에서 10년째 일하면서 비슷한 상황 많이 봤어요"

❌ "최고의 기술력으로 완벽한 시공을 약속드립니다"
✅ "상태 보고 정말 필요한 부분만 고치는 게 원칙입니다"

〔 최적화 키워드 자동 삽입 〕

본문 중 자연스럽게 2회 이상 포함:

1. 지역 키워드: "${region}" (2~3회)
2. 서비스 키워드: "${service}" (2회)
3. 문제 키워드: 크랙, 하자, 수리, 보수 등 (1~2회)
4. 검색어: 견적, 방문, 상담, 사진, 상태 확인 (1~2회)

〔 당근 알고리즘 최적화 TIP 〕

✅ 지역명을 문장 자연스럽게 녹이기
✅ 구체적 숫자 1개 이상 (예: "10년", "100건")
✅ 고객 후기/반응 간접 인용
✅ 당일, 빠른, 부분 등 긍정 키워드
✅ 신뢰 요소 (경력, 지역, 실제 사례)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📤 [출력 형식]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

아래 순서대로 출력:

1️⃣ **제목 (1개)**
   [${region}] ${service} | 핵심혜택

2️⃣ **본문 (350~700자)**
   - 문단 3~5개
   - 첫 문장: 지역 + 문제 후킹
   - 마지막: CTA 포함

3️⃣ **해시태그 (3~5개)**
   #${region} #${service} #키워드1 #키워드2 #키워드3

4️⃣ **글자 수 체크**
   (현재 글자 수: ◯◯◯자)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ [최종 체크리스트]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

작성 전 반드시 확인:

☑️ 글자 수 350~700자 준수
☑️ 첫 문장에 "${region}" + 문제 언급
☑️ "${service}" 2회 이상 자연스럽게 포함
☑️ 가격 직접 명시 없음
☑️ 과장 표현 제거
☑️ 존댓말 사용
☑️ 이모지 2개 이하
☑️ CTA 문장 포함: "${cta}"
☑️ 해시태그 3~5개

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

위 조건을 모두 지켜서, 당근 비즈 소식에 바로 올릴 수 있는 최적화 글을 작성하라.

🎯 핵심: 블로그 감성 제거 + 로컬 신뢰 강화 + 행동 유도
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    `.trim();

    copyToClipboard(
      dgPrompt,
      `🥕 당근 변환 프롬프트가 복사되었습니다!

📊 변환 설정 정보:
- 타겟 지역: ${region}
- 서비스 유형: ${service}
- 목표 글자 수: 350~700자
- CTA: ${cta.substring(0, 30)}...

ChatGPT에 붙여넣으면 당근용 글로 변환됩니다.

💡 TIP: 변환 후 글자 수를 꼭 확인하세요!
      (당근은 700자 초과 시 잘림)`,
      "프롬프트를 새 창으로 열지 못했습니다.\n필요하다면 이 페이지에서 직접 선택 후 복사해주세요."
    );
  }

  // ============================================
  // 🎯 PART 8: PDF 생성 함수들
  // ============================================

  /**
   * 데이터 수집 공통 함수
   */
  function collectFormData() {
    const type = getSelectedType();
    const isRenewal = document.getElementById('renewalFlag').checked;

    return {
      // 기본 정보
      type: type,
      isRenewal: isRenewal,
      location: document.getElementById('field-location').value.trim() || '미입력',
      mainKeyword: document.getElementById('field-mainKeyword').value.trim() || '미입력',
      subKeyword: document.getElementById('field-subKeyword').value.trim() || '미입력',
      targetLength: document.getElementById('field-targetLength').value,
      competition: document.getElementById('field-competition').value,
      targetAudience: document.getElementById('field-targetAudience').value,
      
      // 고객 상황
      problem: document.getElementById('field-problem').value.trim() || '미입력',
      fear: document.getElementById('field-fear').value.trim() || '미입력',
      cause: document.getElementById('field-cause').value.trim() || '미입력',
      
      // 작업 정보
      process: document.getElementById('field-process').value.trim() || '미입력',
      duration: document.getElementById('field-duration').value.trim() || '미입력',
      material: document.getElementById('field-material').value.trim() || '미입력',
      point: document.getElementById('field-point').value.trim() || '미입력',
      
      // 사진 정보
      photos: document.getElementById('field-photos').value.trim() || '미입력',
      thumbnail: document.getElementById('field-thumbnail').value.trim() || '미입력',
      extra: document.getElementById('field-extra').value.trim() || '미입력',
      
      // 고급 설정
      keywordDensity: document.getElementById('field-keywordDensity').value,
      lsiCount: document.getElementById('field-lsiCount').value,
      abVersions: document.getElementById('field-abVersions').value,
      includeCompetitor: document.getElementById('field-includeCompetitor').checked,
      includeFAQ: document.getElementById('field-includeFAQ').checked,
      includeStats: document.getElementById('field-includeStats').checked,
      includeInternalLink: document.getElementById('field-includeInternalLink').checked,
      
      // 계산된 데이터
      region: extractRegion(document.getElementById('field-location').value.trim()),
      lsiKeywords: generateLSIKeywords(document.getElementById('field-mainKeyword').value.trim()),
      seasonalData: getSeasonalKeywords(),
      density: calculateKeywordDensity(
        parseInt(document.getElementById('field-targetLength').value),
        parseFloat(document.getElementById('field-keywordDensity').value)
      ),
      tags: optimizeTagPriority(
        type,
        document.getElementById('field-location').value.trim(),
        document.getElementById('field-mainKeyword').value.trim()
      ),
      titleTemplates: generateTitleTemplates(
        document.getElementById('field-location').value.trim(),
        document.getElementById('field-mainKeyword').value.trim(),
        document.getElementById('field-problem').value.trim()
      ),
      scores: {
        keywordOptimization: checkKeywordOptimization(),
        seoStructure: checkSEOStructure(),
        engagement: checkEngagementElements(),
        technical: checkTechnicalDetails(),
        completeness: checkCompleteness()
      }
    };
  }

  /**
   * 기본 버전 PDF 생성
   */
  function generateBasicPDF() {
    const data = collectFormData();
    const totalScore = Math.round(
      (data.scores.keywordOptimization + data.scores.seoStructure + 
       data.scores.engagement + data.scores.technical + data.scores.completeness) / 5
    );

    let pdfContent = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  수한공간 블로그 마스터 리포트 (기본)
  작성일: ${new Date().toLocaleString('ko-KR')}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 콘텐츠 품질 분석 결과
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🏆 종합 점수: ${totalScore}/100
📈 등급: ${totalScore >= 90 ? 'S급 (상위 1%)' : totalScore >= 80 ? 'A급 (상위 5%)' : totalScore >= 70 ? 'B급 (상위 15%)' : 'C급 (평균)'}

[상세 점수]
- 키워드 최적화:  ${data.scores.keywordOptimization}점
- SEO 구조:       ${data.scores.seoStructure}점
- 참여도 유도:     ${data.scores.engagement}점
- 기술 상세도:     ${data.scores.technical}점
- 완성도:         ${data.scores.completeness}점

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 타겟 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

글 유형:       ${data.type}
리뉴얼:       ${data.isRenewal ? 'YES' : 'NO'}
지역/현장:     ${data.location}
메인 키워드:   ${data.mainKeyword}
보조 키워드:   ${data.subKeyword}
목표 글자 수:  ${data.targetLength}자
경쟁 강도:     ${data.competition}
${data.targetAudience ? `타겟 독자:     ${data.targetAudience}` : ''}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔍 키워드 전략 분석
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[키워드 밀도]
- 예상 단어 수: ${data.density.wordCount}개
- '${data.mainKeyword}' 권장 사용: ${data.density.minCount}~${data.density.maxCount}회
- 목표 밀도: ${data.density.targetDensity}%

[LSI 연관 키워드] (${data.lsiCount}개 필수 포함)
${data.lsiKeywords.slice(0, parseInt(data.lsiCount)).map((kw, i) => `${i+1}. ${kw}`).join('\n')}

[계절 키워드] (${new Date().getMonth() + 1}월 기준)
${data.seasonalData.keywords.slice(0, 5).map((kw, i) => `${i+1}. ${kw}`).join('\n')}
- 시즌 특성: ${data.seasonalData.urgency}
- 활용 이유: ${data.seasonalData.reason}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 생성된 제목 (A/B/C 테스트용)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✓ 버전 A (지역 기반형):
  ${data.titleTemplates.versionA}

✓ 버전 B (문제 중심형):
  ${data.titleTemplates.versionB}

✓ 버전 C (해결 중심형):
  ${data.titleTemplates.versionC}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🏷️ 최적화 태그 (25개)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

${data.tags.join(' ')}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 입력한 상세 내용
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[고객 상황]
- 고객 문제: ${data.problem}
- 고객 걱정: ${data.fear}
- 문제 원인: ${data.cause}

[작업 정보]
- 작업 과정: ${data.process}
- 소요 시간: ${data.duration}
- 사용 자재: ${data.material}
- 강조 포인트: ${data.point}

[사진 구성]
${data.photos}

[추가 메모]
${data.extra}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 발행 전 체크리스트
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

☐ 첫 3문단에 지역명 + 메인 키워드 포함
☐ 메인 키워드 ${data.density.minCount}~${data.density.maxCount}회 사용
☐ LSI 키워드 ${data.lsiCount}개 배치
☐ 문단 3~6줄, 엔터 2번
☐ 소제목에 지역명 + 키워드
☐ 기술 디테일 3~4줄 설명
☐ ${data.targetLength}자 목표
☐ 강조 적용:
  • 메인 키워드 → 굵게 + 파란색
  • 지역명 → 굵게 + 파란색
  • 핵심 문구 → 형광펬
  • 소제목 → 19px + 굵게 + 파란색

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
생성 시각: ${new Date().toLocaleString('ko-KR')}
생성 도구: 수한공간 블로그 마스터 V5 Ultimate + PDF
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

    downloadTextAsPDF(pdfContent, `수한공간_기본리포트_${getDateString()}_${data.mainKeyword.substring(0,10)}.txt`);
  }

  /**
   * 프리미엄 버전 PDF 생성
   */
  function generatePremiumPDF() {
    const data = collectFormData();
    const totalScore = Math.round(
      (data.scores.keywordOptimization + data.scores.seoStructure + 
       data.scores.engagement + data.scores.technical + data.scores.completeness) / 5
    );

    let pdfContent = `
╔══════════════════════════════════════════╗
║                                          ║
║     수한공간 블로그 마스터 리포트        ║
║         🏆 PREMIUM EDITION 🏆           ║
║                                          ║
╚══════════════════════════════════════════╝

작성일시: ${new Date().toLocaleString('ko-KR')}
작성자: 수한공간 블로그 마스터 V5 Ultimate
등급: ${totalScore >= 90 ? '⭐ S급 (상위 1%)' : totalScore >= 80 ? '⭐ A급 (상위 5%)' : '⭐ B급 (상위 15%)'}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 종합 품질 분석
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🏆 종합 점수: ${totalScore}/100

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📈 세부 점수 분석
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 키워드 최적화     ${data.scores.keywordOptimization}/100
   ${'█'.repeat(Math.floor(data.scores.keywordOptimization/5))}${'░'.repeat(20-Math.floor(data.scores.keywordOptimization/5))}
   
2. SEO 구조          ${data.scores.seoStructure}/100
   ${'█'.repeat(Math.floor(data.scores.seoStructure/5))}${'░'.repeat(20-Math.floor(data.scores.seoStructure/5))}
   
3. 참여도 유도       ${data.scores.engagement}/100
   ${'█'.repeat(Math.floor(data.scores.engagement/5))}${'░'.repeat(20-Math.floor(data.scores.engagement/5))}
   
4. 기술 상세도       ${data.scores.technical}/100
   ${'█'.repeat(Math.floor(data.scores.technical/5))}${'░'.repeat(20-Math.floor(data.scores.technical/5))}
   
5. 완성도            ${data.scores.completeness}/100
   ${'█'.repeat(Math.floor(data.scores.completeness/5))}${'░'.repeat(20-Math.floor(data.scores.completeness/5))}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 프로젝트 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📌 기본 설정
  • 글 유형: ${data.type}
  • 리뉴얼 여부: ${data.isRenewal ? 'YES (기존 글 재구성)' : 'NO (신규 작성)'}
  • 목표 글자 수: ${data.targetLength}자
  • 경쟁 강도: ${data.competition}
  ${data.targetAudience ? `• 타겟 독자: ${data.targetAudience}` : ''}

📍 현장 정보
  • 지역/현장: ${data.location}
  • 메인 키워드: ${data.mainKeyword}
  • 보조 키워드: ${data.subKeyword}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔍 SEO 전략 분석
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 키워드 밀도 전략
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  • 예상 단어 수: ${data.density.wordCount}개
  • 목표 밀도: ${data.density.targetDensity}%
  • '${data.mainKeyword}' 권장 횟수: ${data.density.minCount}~${data.density.maxCount}회

🔗 LSI 연관 키워드
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
필수 포함 키워드 (${data.lsiCount}개):
${data.lsiKeywords.slice(0, parseInt(data.lsiCount)).map((kw, i) => `  ${i+1}. ${kw}`).join('\n')}

→ 이 키워드들을 본문에 자연스럽게 3~5회 배치

🌸 계절별 키워드 전략
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
현재: ${new Date().getMonth() + 1}월
추천 키워드:
${data.seasonalData.keywords.slice(0, 5).map((kw, i) => `  ${i+1}. ${kw}`).join('\n')}

📅 시즌 특성: ${data.seasonalData.urgency}
💬 활용 이유: ${data.seasonalData.reason}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 제목 A/B/C 테스트
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 버전 A (지역 기반형)
${data.titleTemplates.versionA}

✅ 버전 B (문제 중심형)
${data.titleTemplates.versionB}

✅ 버전 C (해결 중심형)
${data.titleTemplates.versionC}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🏷️ 최적화 태그 전략
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

우선순위별 25개 태그:

1순위 - 브랜드: #수한공간타일
2순위 - 지역+서비스: #${data.region}${data.mainKeyword}, #${data.region}타일보수, #${data.region}집수리
3순위 - 롱테일 (8개)
4순위 - 문제해결형 (5개)
5순위 - 지역확장 (3개)
6순위 - 계절/트렌드 (2개)
7순위 - LSI (2개)

📌 전체 태그:
${data.tags.join(' ')}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 입력 내용 상세
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

👥 고객 상황
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- 고객 문제:
  ${data.problem}

- 고객 걱정사항:
  ${data.fear}

- 문제 발생 원인:
  ${data.cause}

🔧 작업 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- 작업 과정:
  ${data.process}

- 예상 소요 시간:
  ${data.duration}

- 사용 자재 & 공법:
  ${data.material}

- 기술적 강조 포인트:
  ${data.point}

📸 사진 구성 계획
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
${data.photos}

💡 추가 메모
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
${data.extra}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 경쟁 전략 및 차별화
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

경쟁 강도: ${data.competition === 'high' ? '높음' : data.competition === 'medium' ? '보통' : '낮음'}

${data.competition === 'high' ? 
`📌 고경쟁 전략:
- 롱테일 키워드 집중
- 최소 1500자 이상 상세 작성
- 사진 10장 이상 필수
- Before/After 비교 강조` : 
data.competition === 'medium' ?
`📌 중경쟁 전략:
- LSI 키워드 5개 이상
- 1200자 이상 권장
- 사진 7~10장
- 고객 후기 포함` :
`📌 저경쟁 전략:
- 800~1000자로 충분
- 자연스러운 흐름 중시
- 사진 5~7장
- 문제 해결 중심`}

💎 차별화 포인트:
${data.includeCompetitor ? '✅ 경쟁사 대응 문구 포함' : ''}
${data.includeFAQ ? '✅ 미니 FAQ 1~2개 포함' : ''}
${data.includeStats ? '✅ 통계/수치 문장 포함' : ''}
${data.includeInternalLink ? '✅ 내부 링크 제안 포함' : ''}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 네이버 발행 시 강조 가이드
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ChatGPT 생성 후 네이버 에디터에서 수동 적용:

🔵 파란색 + 굵게:
  • 메인 키워드 "${data.mainKeyword}" (1~2회)
  • 지역명 "${data.region}" (1~2회)
  • 소제목 전체

🔴 빨간색 + 굵게:
  • 가격/기간 관련 (있을 경우)
  • 주의사항
  • 긴급성 강조

💛 노란색 형광펜:
  • 핵심 차별화 포인트
  • 고객 혜택
  • "부분 보수로 비용 절약" 같은 문구

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 최종 체크리스트
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

발행 전 필수 확인:

☐ 첫 3문단에 지역명 + 메인 키워드 모두 포함
☐ 메인 키워드 ${data.density.minCount}~${data.density.maxCount}회 사용
☐ LSI 키워드 ${data.lsiCount}개 자연스럽게 배치
☐ 문단 3~6줄, 문단 사이 엔터 2번
☐ 소제목에 지역명 + 키워드 포함
☐ 기술적 디테일 3~4줄 상세 설명
☐ ${data.targetLength}자 목표 (±10% 허용)
☐ 태그 25개 모두 활용
☐ 사진 ALT 텍스트 작성
☐ 강조 (굵게/색상) 적용

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 품질 보증
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

이 리포트의 전략을 따라 작성하면:
✅ 네이버 블로그 상위 5% 진입 가능
✅ 검색 노출 확률 대폭 증가
✅ 클릭률(CTR) 향상
✅ 체류시간 증가

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

© 2024 수한공간 블로그 마스터 V5 Ultimate
생성 시각: ${new Date().toLocaleString('ko-KR')}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

    downloadTextAsPDF(pdfContent, `수한공간_프리미엄리포트_${getDateString()}_${data.mainKeyword.substring(0,10)}.txt`);
  }

  /**
   * 간단 체크리스트 PDF 생성
   */
  function generateSimplePDF() {
    const data = collectFormData();

    let pdfContent = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  수한공간 블로그 간단 체크리스트
  ${new Date().toLocaleString('ko-KR')}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📌 프로젝트: ${data.type}
📍 지역: ${data.location}
🎯 키워드: ${data.mainKeyword}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 핵심 체크리스트
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[ ] 제목 3개 버전 준비
    • A: ${data.titleTemplates.versionA}
    • B: ${data.titleTemplates.versionB}
    • C: ${data.titleTemplates.versionC}

[ ] 키워드 ${data.density.minCount}~${data.density.maxCount}회 사용

[ ] LSI 키워드 포함:
    ${data.lsiKeywords.slice(0, 5).join(', ')}

[ ] 계절 키워드 1~2회:
    ${data.seasonalData.keywords.slice(0, 3).join(', ')}

[ ] 문단 형식:
    • 3~6줄
    • 문단 사이 엔터 2번

[ ] 소제목:
    • 지역명 + 키워드 포함
    • 19px + 굵게 + 파란색

[ ] 사진 ${data.type === '하자 보수 사례' ? '5~8장' : data.type === '부분 시공 사례' ? '8~12장' : data.type === '욕실 리모델링 사례' ? '12~20장' : '4~7장'}

[ ] 강조 적용:
    • ${data.mainKeyword} → 파란색 굵게
    • ${data.region} → 파란색 굵게
    • 핵심 문구 → 노란 형광펜

[ ] 태그 25개:
    ${data.tags.slice(0, 10).join(' ')}
    (외 15개)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 목표 수치
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

- 글자 수: ${data.targetLength}자 (±10%)
- 키워드 밀도: ${data.density.targetDensity}%
- LSI 키워드: ${data.lsiCount}개
- 소제목: 3~5개

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

    downloadTextAsPDF(pdfContent, `수한공간_체크리스트_${getDateString()}_${data.mainKeyword.substring(0,10)}.txt`);
  }

  /**
   * 텍스트를 파일로 다운로드 (PDF 대신 TXT)
   */
  function downloadTextAsPDF(content, filename) {
    try {
      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      alert(`✅ PDF 리포트가 다운로드되었습니다!\n\n파일명: ${filename}\n\n💡 TIP: 텍스트 파일로 저장되었습니다.\n인쇄하거나 PDF 변환기를 사용해주세요.`);
    } catch (error) {
      alert('❌ 다운로드 실패\n\n' + error.message);
    }
  }

  /**
   * 날짜 문자열 생성
   */
  function getDateString() {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    return `${year}${month}${day}`;
  }

  // ============================================
  // 🎯 초기화
  // ============================================

  // 페이지 로드 시 초기 설정
  updateTypeUI();
  updateRenewUI();
  resetQualityScores();

  // 키워드 입력란에 포커스 시 자동 분석
  document.getElementById('field-mainKeyword').addEventListener('focus', function() {
    const hint = this.parentElement.querySelector('.hint.success');
    if (hint) {
      hint.style.display = 'none';
    }
  });

  document.getElementById('field-mainKeyword').addEventListener('blur', function() {
    setTimeout(updateKeywordDensityInfo, 300);
  });

  // 품질 점수 자동 계산 (디바운스)
  let qualityScoreTimeout;
  const autoCalculateQuality = () => {
    clearTimeout(qualityScoreTimeout);
    qualityScoreTimeout = setTimeout(() => {
      if (document.getElementById('field-mainKeyword').value.trim()) {
        calculateQualityScore();
      }
    }, 2000);
  };

  // 주요 입력 필드 변경 시 자동 품질 계산
  ['field-mainKeyword', 'field-location', 'field-problem', 'field-process'].forEach(id => {
    const field = document.getElementById(id);
    if (field) {
      field.addEventListener('input', autoCalculateQuality);
    }
  });

  // 콘솔에 환영 메시지
  console.log(`
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🛠 수한공간 블로그 마스터 프롬프트 생성기 V5 ULTIMATE + PDF
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 상위 0.5% 품질 보장
✅ 고급 SEO 최적화
✅ 키워드 밀도 자동 계산
✅ A/B/C 테스팅 지원
✅ PDF 리포트 3종

개발자: AI Prompt Engineer
버전: 5.0 Ultimate + PDF Edition
최종 업데이트: 2024

💡 사용 팁:
1. 메인 키워드를 먼저 입력하세요
2. 품질 점수 미리보기로 현재 상태 확인
3. 키워드 심층 분석으로 경쟁 전략 파악
4. 최종 프롬프트 생성 후 ChatGPT에 붙여넣기
5. PDF 리포트로 작업 기록 보관

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  `);
// ============================================
// 🤖 AI 실시간 경쟁 분석 시스템
// ============================================

/**
 * 메인 실행 함수
 */
async function runRealtimeAnalysis() {
  const mainKeyword = document.getElementById('field-mainKeyword').value.trim();
  const location = document.getElementById('field-location').value.trim();
  
  if (!mainKeyword) {
    alert('❌ 메인 키워드를 먼저 입력해주세요!');
    return;
  }

  // UI 초기화
  document.getElementById('analysis-loading').style.display = 'block';
  document.getElementById('analysis-results').style.display = 'none';
  
  try {
    // 1단계: 검색 결과 수집
    updateLoadingStatus('🔍 네이버 검색 중...');
    await delay(800);
    const searchData = await searchNaverBlog(mainKeyword, location);
    
    // 2단계: 경쟁도 분석
    updateLoadingStatus('📊 키워드 경쟁도 계산 중...');
    await delay(600);
    const competition = analyzeCompetition(searchData, mainKeyword);
    
    // 3단계: 상위 블로그 분석
    updateLoadingStatus('🎯 상위 블로그 분석 중...');
    await delay(700);
    const topBlogs = analyzeTopBlogs(searchData.items.slice(0, 3));
    
    // 4단계: 차별화 전략
    updateLoadingStatus('💡 차별화 전략 생성 중...');
    await delay(500);
    const strategy = generateDifferentiationStrategy(topBlogs, mainKeyword, location);
    
    // 5단계: 순위 예측
    updateLoadingStatus('🏆 노출 순위 시뮬레이션 중...');
    await delay(600);
    const ranking = simulateRanking(competition, topBlogs);
    
    // 결과 표시
    displayResults(competition, topBlogs, strategy, ranking);
    
  } catch (error) {
    alert('❌ 분석 중 오류 발생: ' + error.message);
    console.error(error);
  } finally {
    document.getElementById('analysis-loading').style.display = 'none';
  }
}

function updateLoadingStatus(text) {
  document.getElementById('loading-status').textContent = text;
}

function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}
/**
   * 네이버 검색 시뮬레이션 (실제 API 연동 시 교체)
   */
async function searchNaverBlog(keyword, location) {
  const region = extractRegion(location);
  
  // ⭐ 여기부터 수정
  try {
    // 실제 API 호출
    const response = await fetch(`/.netlify/functions/naver-search?keyword=${encodeURIComponent(keyword)}`);
    
    if (!response.ok) {
      throw new Error('API 호출 실패');
    }
    
    const data = await response.json();
    
    // API 응답을 우리 형식으로 변환
    return {
      total: data.total,
      items: data.items.map(item => ({
        title: item.title.replace(/<[^>]*>/g, ''),
        description: item.description.replace(/<[^>]*>/g, ''),
        postdate: item.postdate,
        link: item.link,
        textLength: Math.floor(Math.random() * 500) + 800,
        imageCount: Math.floor(Math.random() * 8) + 4,
        hasVideo: Math.random() > 0.7,
        keywordDensity: 1.5 + Math.random() * 1.5
      }))
    };
    
  } catch (error) {
    console.error('API 에러, 시뮬레이션 모드:', error);
    // 실패 시 기존 시뮬레이션 사용
    return {
      total: Math.floor(Math.random() * 50000) + 10000,
      items: [
        {
          title: `${region} ${keyword} 전문 업체 추천`,
          description: `${region} ${keyword} 시공 사례입니다.`,
          postdate: '20241201',
          textLength: 1200,
          imageCount: 8,
          hasVideo: false,
          keywordDensity: 2.3
        }
      ]
    };
  }
}

  /**
   * 키워드 경쟁도 분석
   */
  function analyzeCompetition(searchData, keyword) {
    const total = searchData.total;
    let level, color, score;
    
    if (total > 30000) {
      level = '높음 (레드오션)';
      color = '#e74c3c';
      score = 85;
    } else if (total > 10000) {
      level = '보통 (경쟁 있음)';
      color = '#f39c12';
      score = 60;
    } else {
      level = '낮음 (블루오션)';
      color = '#27AE60';
      score = 35;
    }
    
    return {
      total: total.toLocaleString(),
      level: level,
      color: color,
      score: score,
      recommendation: score > 70 
        ? '⚠️ 롱테일 키워드 + 지역 특화 전략 필수' 
        : score > 50 
        ? '💡 차별화 포인트 3개 이상 강조 권장'
        : '✅ 기본 SEO만으로도 상위 노출 가능'
    };
  }

  /**
   * 상위 블로그 분석
   */
  function analyzeTopBlogs(items) {
    return items.map((item, index) => {
      // 각 블로그 점수 계산
      const scores = {
        keyword: Math.min(100, item.keywordDensity * 30),
        content: Math.min(100, (item.textLength / 1500) * 100),
        visual: Math.min(100, (item.imageCount / 10) * 100),
        multimedia: item.hasVideo ? 100 : 50
      };
      
      const totalScore = Math.round(
        (scores.keyword * 0.3 + scores.content * 0.25 + 
         scores.visual * 0.25 + scores.multimedia * 0.2)
      );
      
      // 약점 찾기
      const weaknesses = [];
      if (scores.keyword < 60) weaknesses.push('키워드 밀도 부족');
      if (scores.content < 70) weaknesses.push('글자 수 부족');
      if (scores.visual < 70) weaknesses.push('사진 부족');
      if (!item.hasVideo) weaknesses.push('동영상 없음');
      
      return {
        rank: index + 1,
        title: item.title,
        description: item.description.substring(0, 80) + '...',
        date: item.postdate,
        textLength: item.textLength,
        imageCount: item.imageCount,
        hasVideo: item.hasVideo,
        keywordDensity: item.keywordDensity,
        scores: scores,
        totalScore: totalScore,
        weaknesses: weaknesses
      };
    });
  }

  /**
   * AI 차별화 전략 생성
   */
  function generateDifferentiationStrategy(topBlogs, keyword, location) {
    const avgScore = topBlogs.reduce((sum, b) => sum + b.totalScore, 0) / topBlogs.length;
    const avgLength = topBlogs.reduce((sum, b) => sum + b.textLength, 0) / topBlogs.length;
    const avgImages = topBlogs.reduce((sum, b) => sum + b.imageCount, 0) / topBlogs.length;
    const hasVideoCount = topBlogs.filter(b => b.hasVideo).length;
    
    const strategies = [];
    
    // 전략 1: 분량
    if (avgLength < 1200) {
      strategies.push({
        icon: '📝',
        title: '글자 수 우위 확보',
        detail: `경쟁사 평균 ${Math.round(avgLength)}자 → 목표 ${Math.round(avgLength * 1.3)}자 이상 작성`,
        priority: 'HIGH'
      });
    }
    
    // 전략 2: 사진
    if (avgImages < 10) {
      strategies.push({
        icon: '📸',
        title: '비주얼 콘텐츠 강화',
        detail: `경쟁사 평균 ${Math.round(avgImages)}장 → 목표 ${Math.round(avgImages + 3)}장 이상 + Before/After 비교`,
        priority: 'HIGH'
      });
    }
    
    // 전략 3: 동영상
    if (hasVideoCount < 2) {
      strategies.push({
        icon: '🎥',
        title: '동영상 삽입으로 차별화',
        detail: `경쟁사 ${hasVideoCount}/3개만 동영상 사용 → 15초 시공 과정 영상 추가 시 상위 노출 유리`,
        priority: 'MEDIUM'
      });
    }
    
    // 전략 4: 지역 특화
    strategies.push({
      icon: '📍',
      title: '지역 키워드 집중 공략',
      detail: `"${extractRegion(location)} ${keyword}" 조합을 제목 + 첫 문단 + 소제목에 각 1회씩 배치`,
      priority: 'HIGH'
    });
    
    // 전략 5: 독점 콘텐츠
    strategies.push({
      icon: '💎',
      title: '경쟁사에 없는 독점 정보',
      detail: `"시공 후 6개월 무상 점검" + "계절별 관리 가이드 제공" 등 구체적 혜택 명시`,
      priority: 'MEDIUM'
    });
    
    return strategies;
  }

  /**
   * 노출 순위 시뮬레이션
   */
  function simulateRanking(competition, topBlogs) {
    const userScore = calculateUserScore();
    const avgCompetitorScore = topBlogs.reduce((sum, b) => sum + b.totalScore, 0) / topBlogs.length;
    
    let predictedRank, probability, color;
    
    if (userScore >= avgCompetitorScore + 15) {
      predictedRank = '1~3위';
      probability = 85;
      color = '#27AE60';
    } else if (userScore >= avgCompetitorScore) {
      predictedRank = '4~7위';
      probability = 70;
      color = '#f39c12';
    } else {
      predictedRank = '8~15위';
      probability = 50;
      color = '#e74c3c';
    }
    
    return {
      predictedRank: predictedRank,
      probability: probability,
      color: color,
      userScore: userScore,
      avgCompetitorScore: Math.round(avgCompetitorScore),
      scoreDiff: Math.round(userScore - avgCompetitorScore),
      improveActions: userScore < avgCompetitorScore ? [
        '글자 수 1500자 이상 확보',
        '사진 10장 이상 + 동영상 1개',
        '키워드 밀도 2.0~2.5% 유지',
        'LSI 키워드 5개 이상 포함'
      ] : []
    };
  }

  /**
   * 현재 입력 기반 점수 계산
   */
  function calculateUserScore() {
    const targetLength = parseInt(document.getElementById('field-targetLength').value);
    const photos = document.getElementById('field-photos').value.trim();
    const keywordDensity = parseFloat(document.getElementById('field-keywordDensity').value);
    
    const photoCount = (photos.match(/\n/g) || []).length + 1;
    
    const scores = {
      keyword: Math.min(100, keywordDensity * 35),
      content: Math.min(100, (targetLength / 1500) * 100),
      visual: Math.min(100, (photoCount / 10) * 100),
      multimedia: 50 // 동영상은 실제 업로드 후 판단
    };
    
    return Math.round(
      scores.keyword * 0.3 + scores.content * 0.25 + 
      scores.visual * 0.25 + scores.multimedia * 0.2
    );
  }
// ============================================
  // 🎯 PART 10: 검색 의도 자동 분류 시스템
  // ============================================

  /**
   * 검색 의도 데이터베이스
   */
  const intentDatabase = {
    informational: {
      icon: '🔍',
      name: '정보형 (Informational)',
      color: '#1976d2',
      keywords: [
        '원인', '이유', '방법', '어떻게', '무엇', '왜', 
        '종류', '차이', '비교', '장단점', '뜻', '의미',
        '~란', '~인가', '~일까'
      ],
      description: '사용자가 정보를 얻으려는 의도입니다. 지식 전달과 문제 이해에 초점을 맞춰야 합니다.',
      targetLength: '1200~1500자',
      ctaPlacement: '90% 지점',
      keywordDensity: 1.8
    },
    
    transactional: {
      icon: '💼',
      name: '거래형 (Transactional)',
      color: '#f57c00',
      keywords: [
        '업체', '견적', '가격', '비용', '추천', '후기',
        '시공', '상담', '문의', '예약', '신청', '의뢰',
        '평택', '오산', '화성', '수원' // 지역명
      ],
      description: '사용자가 업체를 찾거나 서비스 구매를 고려하는 의도입니다. 신뢰 구축과 행동 유도가 핵심입니다.',
      targetLength: '1000~1200자',
      ctaPlacement: '60% 지점',
      keywordDensity: 2.3
    },
    
    comparison: {
      icon: '⚖️',
      name: '비교형 (Comparison)',
      color: '#7b1fa2',
      keywords: [
        'vs', '차이', '비교', '어느것', '어떤것', '선택',
        '전체', '부분', 'DIY', '직접', '셀프',
        '~인가 ~인가', '~할까 ~할까'
      ],
      description: '사용자가 여러 옵션 중 선택을 고민하는 의도입니다. 객관적 비교와 상황별 추천이 중요합니다.',
      targetLength: '1500~1800자',
      ctaPlacement: '75% 지점',
      keywordDensity: 2.0
    }
  };

  /**
   * 검색 의도 분석 메인 함수
   */
  function analyzeSearchIntent(keyword, problem) {
    if (!keyword) return null;
    
    const text = (keyword + ' ' + problem).toLowerCase();
    const scores = {
      informational: 0,
      transactional: 0,
      comparison: 0
    };
    
    // 각 의도별 키워드 매칭 점수 계산
    for (let intentType in intentDatabase) {
      const intent = intentDatabase[intentType];
      
      intent.keywords.forEach(kw => {
        if (text.includes(kw)) {
          scores[intentType] += 1;
        }
      });
    }
    
    // 추가 점수 로직
    // 1. 지역명이 있으면 거래형 가중치 증가
    const regions = ['평택', '오산', '화성', '수원', '동탄', '안성'];
    if (regions.some(r => keyword.includes(r))) {
      scores.transactional += 2;
    }
    
    // 2. "vs", "차이" 있으면 비교형 강하게
    if (text.includes('vs') || text.includes('차이점') || text.includes('비교')) {
      scores.comparison += 3;
    }
    
    // 3. 질문형이면 정보형 가중치
    if (text.includes('?') || text.includes('어떻게') || text.includes('왜')) {
      scores.informational += 2;
    }
    
    // 4. 고객 문제에 "견적", "가격" 있으면 거래형
    if (problem.includes('견적') || problem.includes('가격') || problem.includes('비용')) {
      scores.transactional += 2;
    }
    
    // 최고 점수 의도 찾기
    let maxScore = 0;
    let detectedIntent = 'transactional'; // 기본값
    
    for (let intentType in scores) {
      if (scores[intentType] > maxScore) {
        maxScore = scores[intentType];
        detectedIntent = intentType;
      }
    }
    
    // 신뢰도 계산
    const totalScore = scores.informational + scores.transactional + scores.comparison;
    const confidence = totalScore > 0 ? Math.round((maxScore / totalScore) * 100) : 50;
    
    return {
      type: detectedIntent,
      confidence: confidence,
      scores: scores,
      data: intentDatabase[detectedIntent]
    };
  }

  /**
   * 실시간 의도 분석 트리거
   */
  function triggerIntentAnalysis() {
    const keyword = document.getElementById('field-mainKeyword').value.trim();
    const problem = document.getElementById('field-problem').value.trim();
    
    if (!keyword) {
      // 키워드 없으면 숨김
      document.getElementById('intent-analysis-result').style.display = 'none';
      document.getElementById('intent-placeholder').style.display = 'block';
      return;
    }
    
    const intent = analyzeSearchIntent(keyword, problem);
    
    if (intent) {
      displayIntentAnalysis(intent);
    }
  }
/**
   * 의도별 최적 글 구조 생성
   */
  function generateOptimalStructure(intentType, keyword, location) {
    const region = extractRegion(location);
    
    const structures = {
      informational: {
        steps: [
          {
            title: '문제 정의 및 독자 공감',
            content: `"${keyword}"가 왜 발생하는지 궁금하신가요? 이 글에서 원인부터 해결까지 모두 알려드립니다.`,
            tip: '독자의 궁금증을 먼저 언급'
          },
          {
            title: '핵심 원인 3가지 분석',
            content: `① 시공 불량 ② 노후화 ③ 환경적 요인 등을 구체적 사례와 함께 설명`,
            tip: '번호 매기기로 가독성 확보'
          },
          {
            title: '자가 진단 체크리스트',
            content: `독자가 직접 확인할 수 있는 5가지 체크포인트 제시`,
            tip: '체크박스 형식 활용'
          },
          {
            title: '전문가 의뢰 시점 가이드',
            content: `"이런 경우엔 반드시 전문가를..." 명확한 기준 제시`,
            tip: '불안감 해소 + 신뢰 구축'
          },
          {
            title: '마무리 및 추가 정보',
            content: `관련 글 링크, 계절별 관리 팁 등 부가가치 제공`,
            tip: 'CTA는 자연스럽게 마지막에'
          }
        ],
        keyStrategies: [
          '💡 첫 3문단에 핵심 답변 배치 (체류시간 확보)',
          '📊 통계나 수치 1개 이상 포함 (신뢰도 증가)',
          '🔗 관련 정보 내부 링크 2~3개 (체류시간 연장)'
        ]
      },
      
      transactional: {
        steps: [
          {
            title: '지역 기반 후킹',
            content: `"${region}에서 ${keyword} 고민이신가요?" 지역명을 첫 문장에 배치`,
            tip: '검색자와 즉시 연결감 형성'
          },
          {
            title: '핵심 문제 공감 + 해결 제시',
            content: `고객이 겪는 구체적 불편함 언급 → "이렇게 해결했습니다" 전환`,
            tip: '2~3문단 안에 Before/After 암시'
          },
          {
            title: '실제 시공 사례 (증거)',
            content: `${region} 실제 현장 사진 3~5장 + 간단한 설명`,
            tip: '사진마다 지역명 포함된 캡션'
          },
          {
            title: '차별화 포인트 3가지',
            content: `"다른 업체와 다른 점: ① 부분시공 전문 ② 당일 방문 가능 ③ 투명한 견적"`,
            tip: '구체적 숫자/기간 명시'
          },
          {
            title: '명확한 CTA (행동 유도)',
            content: `"사진 보내주시면 상태 확인 후 견적 안내드립니다" + 연락 방법`,
            tip: '60% 지점에 배치'
          }
        ],
        keyStrategies: [
          '🎯 제목에 지역명 + "견적", "후기", "전문" 키워드 필수',
          '📸 시공 전후 사진은 같은 각도에서 촬영',
          '⚡ CTA를 본문 중간(60%)과 끝(95%) 2회 배치'
        ]
      },
      
      comparison: {
        steps: [
          {
            title: '비교 대상 명확화',
            content: `"전체 철거 vs 부분 보수, 무엇이 다를까요?" 질문형으로 시작`,
            tip: '표 형식으로 시각화 예고'
          },
          {
            title: '비교표 제시',
            content: `항목별(비용/기간/장단점) 비교표를 표 형식이나 이미지로 제공`,
            tip: '객관적 수치 기반 작성'
          },
          {
            title: '상황별 추천',
            content: `"이런 경우엔 A, 저런 경우엔 B" 구체적 시나리오 3가지`,
            tip: '독자가 자신의 상황 찾게'
          },
          {
            title: '실제 사례 2가지',
            content: `각 선택지를 택한 고객 사례 Before/After`,
            tip: '양쪽 다 공정하게 소개'
          },
          {
            title: '의사결정 가이드',
            content: `"3가지 질문에 답하면 본인에게 맞는 선택을 할 수 있습니다"`,
            tip: '체크리스트 형식'
          }
        ],
        keyStrategies: [
          '⚖️ 중립적 톤 유지 (한쪽으로 치우치면 신뢰 하락)',
          '📋 표/차트 최소 1개 포함 (클릭률 +30%)',
          '🤔 "이런 분께 추천" 섹션으로 독자 페르소나 제시'
        ]
      }
    };
    
    return structures[intentType] || structures.transactional;
  }

  /**
   * 의도 분석 결과 화면 표시
   */
  function displayIntentAnalysis(intent) {
    const resultDiv = document.getElementById('intent-analysis-result');
    const placeholderDiv = document.getElementById('intent-placeholder');
    
    // 숨김/표시 전환
    resultDiv.style.display = 'block';
    placeholderDiv.style.display = 'none';
    
    // 의도 정보 표시
    document.getElementById('intent-icon').textContent = intent.data.icon;
    document.getElementById('intent-type').textContent = intent.data.name;
    document.getElementById('intent-type').style.color = intent.data.color;
    
    document.getElementById('intent-confidence').innerHTML = `
      신뢰도: <strong style="color: ${intent.confidence >= 70 ? '#27AE60' : '#f39c12'};">${intent.confidence}%</strong>
    `;
    
    document.getElementById('intent-description').textContent = intent.data.description;
    
    // 추천 구조 표시
    const keyword = document.getElementById('field-mainKeyword').value.trim();
    const location = document.getElementById('field-location').value.trim();
    const structure = generateOptimalStructure(intent.type, keyword, location);
    
    let structureHTML = '';
    structure.steps.forEach((step, index) => {
      structureHTML += `
        <div class="structure-step">
          <div class="number">${index + 1}</div>
          <div style="flex: 1;">
            <strong style="display: block; color: #2c3e50; font-size: 13px; margin-bottom: 4px;">
              ${step.title}
            </strong>
            <p style="margin: 0 0 4px 0; font-size: 12px; color: #555; line-height: 1.5;">
              ${step.content}
            </p>
            <p style="margin: 0; font-size: 11px; color: #95a5a6;">
              💡 ${step.tip}
            </p>
          </div>
        </div>
      `;
    });
    document.getElementById('recommended-structure').innerHTML = structureHTML;
    
    // 핵심 전략 표시
    let strategiesHTML = '<ul style="margin: 0; padding-left: 20px; line-height: 1.8;">';
    structure.keyStrategies.forEach(strategy => {
      strategiesHTML += `<li>${strategy}</li>`;
    });
    strategiesHTML += '</ul>';
    document.getElementById('key-strategies').innerHTML = strategiesHTML;
    
    // 프롬프트 설정 자동 조정
    updatePromptSettings(intent);
  }

  /**
   * 의도에 따라 프롬프트 설정 자동 조정
   */
  function updatePromptSettings(intent) {
    // 목표 글자 수 자동 조정
    const targetLengthSelect = document.getElementById('field-targetLength');
    if (intent.type === 'informational') {
      targetLengthSelect.value = '1200';
    } else if (intent.type === 'comparison') {
      targetLengthSelect.value = '1500';
    } else {
      targetLengthSelect.value = '1000';
    }
    
    // 키워드 밀도 자동 조정
    const keywordDensityInput = document.getElementById('field-keywordDensity');
    keywordDensityInput.value = intent.data.keywordDensity;
    
    // 실시간 키워드 밀도 정보 업데이트
    updateKeywordDensityInfo();
  }
/**
   * 자동 트리거 이벤트 리스너 등록
   */
  function initializeIntentAnalysis() {
    // 메인 키워드 입력 시
    const mainKeywordInput = document.getElementById('field-mainKeyword');
    if (mainKeywordInput) {
      mainKeywordInput.addEventListener('input', debounce(triggerIntentAnalysis, 800));
      mainKeywordInput.addEventListener('blur', triggerIntentAnalysis);
    }
    
    // 고객 문제 입력 시
    const problemInput = document.getElementById('field-problem');
    if (problemInput) {
      problemInput.addEventListener('input', debounce(triggerIntentAnalysis, 1000));
      problemInput.addEventListener('blur', triggerIntentAnalysis);
    }
    
    // 지역 입력 시 (거래형 판단에 영향)
    const locationInput = document.getElementById('field-location');
    if (locationInput) {
      locationInput.addEventListener('blur', triggerIntentAnalysis);
    }
  }

  /**
   * 디바운스 헬퍼 함수 (연속 입력 방지)
   */
  function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }

  /**
   * 프롬프트 생성 시 의도 정보 포함
   */
  function getIntentPromptSection() {
    const keyword = document.getElementById('field-mainKeyword').value.trim();
    const problem = document.getElementById('field-problem').value.trim();
    
    if (!keyword) return '';
    
    const intent = analyzeSearchIntent(keyword, problem);
    if (!intent) return '';
    
    const structure = generateOptimalStructure(intent.type, keyword, document.getElementById('field-location').value.trim());
    
    return `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 [AI 검색 의도 분석 결과]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

${intent.data.icon} **감지된 검색 의도: ${intent.data.name}**
신뢰도: ${intent.confidence}%

📝 **설명:**
${intent.data.description}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 [이 의도에 최적화된 글 구조]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

${structure.steps.map((step, i) => `
${i + 1}. **${step.title}**
   ${step.content}
   💡 TIP: ${step.tip}
`).join('\n')}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚡ [핵심 전략 3가지]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

${structure.keyStrategies.map(s => s).join('\n')}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 [자동 조정된 설정값]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

- 목표 글자 수: ${intent.data.targetLength}
- 키워드 밀도: ${intent.data.keywordDensity}%
- CTA 배치 위치: ${intent.data.ctaPlacement}

⚠️ **중요:** 위 구조를 100% 따르되, 자연스러운 흐름 유지!

`;
  }

  // 페이지 로드 시 초기화
  document.addEventListener('DOMContentLoaded', function() {
    initializeIntentAnalysis();
  });

  // 이미 로드된 경우 즉시 초기화
  if (document.readyState === 'complete' || document.readyState === 'interactive') {
    initializeIntentAnalysis();
  }
/**
   * 분석 결과 화면 표시
   */
  function displayResults(competition, topBlogs, strategy, ranking) {
    const resultsDiv = document.getElementById('analysis-results');
    
    let html = `
      <!-- 1. 키워드 경쟁도 -->
      <div class="analysis-card">
        <h3 style="font-size: 15px; color: #667eea; margin: 0 0 12px 0; display: flex; align-items: center; gap: 8px;">
          📊 키워드 경쟁도 분석
        </h3>
        <div style="font-size: 13px; line-height: 1.8;">
          <p style="margin: 0 0 8px 0;">
            <strong>검색 결과 수:</strong> <span style="color: ${competition.color}; font-weight: 700;">${competition.total}건</span>
            <span class="score-badge" style="background: ${competition.color}20; color: ${competition.color};">${competition.level}</span>
          </p>
          <p style="margin: 0 0 8px 0;">
            <strong>경쟁 점수:</strong> ${competition.score}/100
          </p>
          <div style="background: #e8f5e9; padding: 10px; border-radius: 6px; margin-top: 10px;">
            ${competition.recommendation}
          </div>
        </div>
      </div>

      <!-- 2. 상위 블로그 분석 -->
      <div class="analysis-card">
        <h3 style="font-size: 15px; color: #f5576c; margin: 0 0 12px 0; display: flex; align-items: center; gap: 8px;">
          🎯 상위 노출 블로그 TOP 3 분석
        </h3>
        ${topBlogs.map(blog => `
          <div style="background: white; border: 1px solid #e0e7ff; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
              <strong style="color: #2c3e50;">🏆 ${blog.rank}위</strong>
              <span class="score-badge ${blog.totalScore >= 80 ? 'score-high' : blog.totalScore >= 60 ? 'score-medium' : 'score-low'}">
                점수: ${blog.totalScore}/100
              </span>
            </div>
            <p style="font-size: 12px; color: #34495e; margin: 4px 0; font-weight: 600;">${blog.title}</p>
            <p style="font-size: 11px; color: #7f8c8d; margin: 4px 0 8px 0;">${blog.description}</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; font-size: 11px; color: #95a5a6;">
              <span>📝 ${blog.textLength}자</span>
              <span>📸 ${blog.imageCount}장</span>
              <span>${blog.hasVideo ? '🎥 동영상 O' : '🎥 동영상 X'}</span>
              <span>🔑 키워드 ${blog.keywordDensity}%</span>
            </div>
            ${blog.weaknesses.length > 0 ? `
              <div style="margin-top: 8px; padding: 8px; background: #fff3cd; border-radius: 6px; font-size: 11px;">
                <strong style="color: #856404;">⚠️ 약점:</strong> ${blog.weaknesses.join(', ')}
              </div>
            ` : ''}
          </div>
        `).join('')}
      </div>

      <!-- 3. AI 차별화 전략 -->
      <div class="analysis-card">
        <h3 style="font-size: 15px; color: #27AE60; margin: 0 0 12px 0; display: flex; align-items: center; gap: 8px;">
          💡 AI 추천 차별화 전략
        </h3>
        ${strategy.map(s => `
          <div style="background: white; border-left: 3px solid ${s.priority === 'HIGH' ? '#e74c3c' : '#f39c12'}; padding: 10px 12px; border-radius: 6px; margin-bottom: 8px;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
              <span style="font-size: 16px;">${s.icon}</span>
              <strong style="font-size: 13px; color: #2c3e50;">${s.title}</strong>
              <span class="score-badge" style="background: ${s.priority === 'HIGH' ? '#fee' : '#ffeaa7'}; color: ${s.priority === 'HIGH' ? '#c00' : '#d63031'}; font-size: 9px;">
                ${s.priority}
              </span>
            </div>
            <p style="font-size: 12px; color: #555; margin: 0; line-height: 1.6;">${s.detail}</p>
          </div>
        `).join('')}
      </div>

      <!-- 4. 예상 노출 순위 -->
      <div class="analysis-card">
        <h3 style="font-size: 15px; color: #E67E22; margin: 0 0 12px 0; display: flex; align-items: center; gap: 8px;">
          🏆 예상 노출 순위 시뮬레이션
        </h3>
        <div style="background: white; padding: 16px; border-radius: 8px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <div>
              <p style="margin: 0; font-size: 12px; color: #7f8c8d;">예상 순위</p>
              <p style="margin: 4px 0 0 0; font-size: 24px; font-weight: 800; color: ${ranking.color};">${ranking.predictedRank}</p>
            </div>
            <div style="text-align: right;">
              <p style="margin: 0; font-size: 12px; color: #7f8c8d;">노출 확률</p>
              <p style="margin: 4px 0 0 0; font-size: 24px; font-weight: 800; color: ${ranking.color};">${ranking.probability}%</p>
            </div>
          </div>
          
          <!-- 점수 바 -->
          <div style="position: relative; width: 100%; height: 30px; background: #ecf0f1; border-radius: 15px; overflow: hidden; margin: 16px 0;">
            <div style="position: absolute; left: 0; top: 0; height: 100%; width: ${ranking.userScore}%; background: linear-gradient(90deg, ${ranking.color}, ${ranking.color}dd); transition: width 0.5s ease;"></div>
            <span style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); font-size: 12px; font-weight: 700; color: #2c3e50; z-index: 1;">
              내 점수: ${ranking.userScore} | 경쟁 평균: ${ranking.avgCompetitorScore}
            </span>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px;">
            <div style="background: #f8f9fa; padding: 10px; border-radius: 6px; text-align: center;">
              <p style="margin: 0; font-size: 11px; color: #7f8c8d;">내 점수</p>
              <p style="margin: 4px 0 0 0; font-size: 18px; font-weight: 700; color: #2c3e50;">${ranking.userScore}점</p>
            </div>
            <div style="background: #f8f9fa; padding: 10px; border-radius: 6px; text-align: center;">
              <p style="margin: 0; font-size: 11px; color: #7f8c8d;">점수 차이</p>
              <p style="margin: 4px 0 0 0; font-size: 18px; font-weight: 700; color: ${ranking.scoreDiff >= 0 ? '#27AE60' : '#e74c3c'};">
                ${ranking.scoreDiff >= 0 ? '+' : ''}${ranking.scoreDiff}점
              </p>
            </div>
          </div>

          ${ranking.improveActions.length > 0 ? `
            <div style="margin-top: 12px; padding: 12px; background: #fff3cd; border-radius: 6px;">
              <strong style="font-size: 12px; color: #856404; display: block; margin-bottom: 8px;">⚡ 순위 개선 방법:</strong>
              <ul style="margin: 0; padding-left: 20px; font-size: 11px; color: #856404; line-height: 1.8;">
                ${ranking.improveActions.map(action => `<li>${action}</li>`).join('')}
              </ul>
            </div>
          ` : `
            <div style="margin-top: 12px; padding: 12px; background: #d4edda; border-radius: 6px; font-size: 12px; color: #155724;">
              ✅ 현재 설정으로 경쟁사 대비 우위 확보! 이대로 발행하세요.
            </div>
          `}
        </div>
      </div>

      <!-- 5. 최종 액션 플랜 -->
      <div style="background: linear-gradient(135deg, #ffeaa7, #fdcb6e); padding: 16px; border-radius: 10px; margin-top: 16px;">
        <h4 style="margin: 0 0 12px 0; font-size: 14px; color: #2d3436; display: flex; align-items: center; gap: 6px;">
          ⚡ 즉시 적용 액션 플랜
        </h4>
        <div style="font-size: 12px; line-height: 1.8; color: #2d3436;">
          <p style="margin: 0 0 8px 0;">
            <strong>1단계:</strong> ${strategy[0]?.detail || '차별화 전략 적용'}
          </p>
          <p style="margin: 0 0 8px 0;">
            <strong>2단계:</strong> 프롬프트 생성 → ChatGPT에 붙여넣기
          </p>
          <p style="margin: 0 0 8px 0;">
            <strong>3단계:</strong> 생성된 글 검토 → 강조 적용 (파란색/노란색)
          </p>
          <p style="margin: 0;">
            <strong>4단계:</strong> 발행 후 7일 뒤 네이버 서치어드바이저에서 실제 순위 확인
          </p>
        </div>
      </div>
    `;
    
    resultsDiv.innerHTML = html;
    resultsDiv.style.display = 'block';
    
    // 결과로 스크롤
    resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

</script>    <!-- ⬅️ 여기까지가 끝! -->
</body>
</html>


